{"aid": "40260493", "title": "Pgdsat \u2013 Postgres database security assessment tool for CIS benchmarks", "url": "https://github.com/HexaCluster/pgdsat", "domain": "github.com/hexacluster", "votes": 1, "user": "avi_vallarapu", "posted_at": "2024-05-04 21:38:31", "comments": 0, "source_title": "GitHub - HexaCluster/pgdsat: PostgreSQL Database Security Assessment Tool", "source_text": "GitHub - HexaCluster/pgdsat: PostgreSQL Database Security Assessment Tool\n\nSkip to content\n\n## Navigation Menu\n\nSign in\n\n# Search code, repositories, users, issues, pull requests...\n\nSearch syntax tips\n\nSign in\n\nSign up\n\nYou signed in with another tab or window. Reload to refresh your session. You\nsigned out in another tab or window. Reload to refresh your session. You\nswitched accounts on another tab or window. Reload to refresh your session.\nDismiss alert\n\nHexaCluster / pgdsat Public\n\n  * Notifications\n  * Fork 4\n  * Star 47\n\nPostgreSQL Database Security Assessment Tool\n\n### License\n\nGPL-3.0 license\n\n47 stars 4 forks Branches Tags Activity\n\nStar\n\nNotifications\n\n# HexaCluster/pgdsat\n\nThis commit does not belong to any branch on this repository, and may belong\nto a fork outside of the repository.\n\n2 Branches\n\n2 Tags\n\n## Folders and files\n\nName| Name| Last commit message| Last commit date  \n---|---|---|---  \n  \n## Latest commit\n\ndaroldFix parsing of pg_hba.conf when host is fqdn. Thanks to Dennis for\nth...Apr 26, 2024e97463d \u00b7 Apr 26, 2024Apr 26, 2024\n\n## History\n\n31 Commits  \n  \n### doc\n\n|\n\n### doc\n\n| Add requirement information about Perl package perl-bignum and perl-M...|\nApr 25, 2024  \n  \n### lib\n\n|\n\n### lib\n\n| Fix parsing of pg_hba.conf when host is fqdn. Thanks to Dennis for th...|\nApr 26, 2024  \n  \n### rsc\n\n|\n\n### rsc\n\n| Add project files| Apr 8, 2024  \n  \n### sample\n\n|\n\n### sample\n\n| Add a check to ensure a data anonymization extension is installed.| Apr 17,\n2024  \n  \n### CONTRIBUTING.md\n\n|\n\n### CONTRIBUTING.md\n\n| Add project files| Apr 8, 2024  \n  \n### ChangeLog\n\n|\n\n### ChangeLog\n\n| Fix typo| Apr 20, 2024  \n  \n### LICENSE\n\n|\n\n### LICENSE\n\n| Add project files| Apr 8, 2024  \n  \n### MANIFEST\n\n|\n\n### MANIFEST\n\n| Add project files| Apr 8, 2024  \n  \n### Makefile.PL\n\n|\n\n### Makefile.PL\n\n| Update ChangeLog and version to v1.1| Apr 19, 2024  \n  \n### README.md\n\n|\n\n### README.md\n\n| Add requirement information about Perl package perl-bignum and perl-M...|\nApr 25, 2024  \n  \n### pgdsat\n\n|\n\n### pgdsat\n\n| Update ChangeLog and version to v1.1| Apr 19, 2024  \n  \n## Repository files navigation\n\n## NAME\n\npgdsat - PostgreSQL Database Security Assessment Tool\n\n## DESCRIPTION\n\nPGDSAT is a security assessment tool that checks around 70 PostgreSQL security\ncontrols of your PostgreSQL clusters including all recommendations from the\nCIS compliance benchmark but not only.\n\nThis tool is a single command that must be run on the PostgreSQL server to\ncollect all necessaries system and PostgreSQL information to compute a\nsecurity assessment report. A report consist in a summary of all tests status\nand a second part with all detailed information. See sample report.\n\nThis PostgreSQL Security Assessment Tool allow assessments to be carried out\nin an automated manner to verify the security policies established inside the\ncompany. It also gives understanding of the security issued that your cluster\ncan be faced.\n\nAlthough the default text output format can be read directly from a terminal\nthe use of the HTML output format is recommended for better reading as you can\nsee in the sample report above.\n\n## SECURITY CHECKS\n\nAll checks recommended by the CIS Benchmark for PostgreSQL 16 are implemented\nbut not only. Some additional tests not part of the CIS document are marked\nwith the \"(*)\" mention in the description.\n\nHere is the list all checks performed on a PostgreSQL cluster. Some must be\nchecked manually but most of them are check automatically by the tool.\n\n    \n    \n    1 - Installation and Patches 1.1 - Ensure packages are obtained from authorized repositories => SUCCESS 1.1.1 - PostgreSQL packages installed. (Manual) 1.1.2 - Ensure packages are obtained from PGDG => SUCCESS 1.2 - Ensure systemd Service Files Are Enabled => SUCCESS 1.3 - Ensure Data Cluster Initialized Successfully => SUCCESS 1.3.1 - Check initialization of the PGDATA => SUCCESS 1.3.2 - Check version in PGDATA => SUCCESS 1.3.3 - Ensure Data Cluster have checksum enabled => FAILURE 1.3.4 - Ensure WALs and temporary files are not on the same partition as the PGDATA => FAILURE 1.3.5 - Ensure that the PGDATA partition is encrypted (Manual) 1.4 - Ensure PostgreSQL versions are up-to-date => FAILURE 1.5 - Ensure unused PostgreSQL extensions are removed (Manual) 2 - Directory and File Permissions 2.1 - Ensure the file permissions mask is correct => FAILURE 2.2 - Check permissions of PGDATA => SUCCESS 2.3 - List content of PGDATA to check unwanted files and symlinks (Manual) 2.4 - Check permissions of pg_hba.conf => SUCCESS 2.5 - Check permissions on Unix Socket => FAILURE 3 - Logging And Auditing 3.1 - PostgreSQL Logging => SUCCESS 3.1.1 - Logging Rationale => SUCCESS 3.1.2 - Ensure the log destinations are set correctly => SUCCESS 3.1.3 - Ensure the logging collector is enabled => FAILURE 3.1.4 - Ensure the log file destination directory is set correctly => SUCCESS 3.1.5 - Ensure the filename pattern for log files is set correctly (Manual) 3.1.6 - Ensure the log file permissions are set correctly => SUCCESS 3.1.7 - Ensure 'log_truncate_on_rotation' is enabled => SUCCESS 3.1.8 - Ensure the maximum log file lifetime is set correctly (Manual) 3.1.9 - Ensure the maximum log file size is set correctly (Manual) 3.1.10 - Ensure the correct syslog facility is selected (Manual) 3.1.11 - Ensure syslog messages are not suppressed => SUCCESS 3.1.12 - Ensure syslog messages are not lost due to size => SUCCESS 3.1.13 - Ensure the program name for PostgreSQL syslog messages is correct (Manual) 3.1.14 - Ensure the correct messages are written to the server log => SUCCESS 3.1.15 - Ensure the correct SQL statements generating errors are recorded => SUCCESS 3.1.16 - Ensure 'debug_print_parse' is disabled => SUCCESS 3.1.17 - Ensure 'debug_print_rewritten' is disabled => SUCCESS 3.1.18 - Ensure 'debug_print_plan' is disabled => SUCCESS 3.1.19 - Ensure 'debug_pretty_print' is enabled => SUCCESS 3.1.20 - Ensure 'log_connections' is enabled => FAILURE 3.1.21 - Ensure 'log_disconnections' is enabled => FAILURE 3.1.22 - Ensure 'log_error_verbosity' is set correctly => FAILURE 3.1.23 - Ensure 'log_hostname' is set correctly => SUCCESS 3.1.24 - Ensure 'log_line_prefix' is set correctly => FAILURE 3.1.25 - Ensure 'log_statement' is set correctly => FAILURE 3.1.26 - Ensure 'log_timezone' is set correctly => FAILURE 3.1.27 - Ensure that log_directory is outside the PGDATA => SUCCESS 3.2 - Ensure the PostgreSQL Audit Extension (pgAudit) is enabled => SUCCESS 4 - User Access and Authorization 4.1 - Ensure sudo is configured correctly (Manual) 4.2 - Ensure excessive administrative privileges are revoked => FAILURE 4.3 - Ensure excessive function privileges are revoked (Manual) 4.4 - Ensure excessive DML privileges are revoked (Manual) 4.5 - Ensure Row Level Security (RLS) is configured correctly (Manual) 4.6 - Ensure the set_user extension is installed (Manual) => FAILURE 4.7 - Make use of predefined roles (Manual) 4.8 - Ensuse the public schema is protected 5 - Connection and Login 5.1 - Ensure login via \"local\" UNIX Domain Socket is configured correctly => FAILURE 5.2 - Ensure login via \"host\" TCP/IP Socket is configured correctly => SUCCESS 5.3 - Ensure Password Complexity is configured => SUCCESS 5.4 - Ensure authentication timeout and delay are well configured => FAILURE 5.5 - Ensure SSL is used for client connection => FAILURE 5.6 - Ensure authorized Ip addresses ranges are not too large => SUCCESS 5.7 - Ensure specific database and users are used => FAILURE 5.8 - Ensure superusers are not allowed to connect remotely => SUCCESS 5.9 - Ensure that 'password_encryption' is correctly set => SUCCESS 6 - PostgreSQL Settings 6.1 - Understanding attack vectors and runtime parameters 6.2 - Ensure 'backend' runtime parameters are configured correctly => FAILURE 6.3 - Ensure 'Postmaster' runtime parameters are configured correctly (Manual) 6.4 - Ensure 'SIGHUP' runtime parameters are configured correctly (Manual) 6.5 - Ensure 'Superuser' runtime parameters are configured correctly (Manual) 6.6 - Ensure 'User' runtime parameters are configured correctly (Manual) 6.7 - Ensure FIPS 140-2 OpenSSL cryptography is used => FAILURE 6.8 - Ensure TLS is enabled and configured correctly => FAILURE 6.9 - Ensure a cryptographic extension is installed => SUCCESS 7 - Replication 7.1 - Ensure a replication-only user is created and used for streaming replication => FAILURE 7.2 - Ensure logging of replication commands is configured => FAILURE 7.3 - Ensure base backups are configured and functional => SUCCESS 7.4 - Ensure WAL archiving is configured and functional => FAILURE 7.5 - Ensure streaming replication parameters are configured correctly => FAILURE 8 - Special Configuration Considerations 8.1 - Ensure PostgreSQL subdirectory locations are outside the data cluster => SUCCESS 8.2 - Ensure the backup and restore tool, 'pgBackRest', is installed and configured => FAILURE 8.3 - Ensure miscellaneous configuration settings are correct (Manual)\n\n## REQUIREMENT\n\nPGDSAT is a standalone program that can be run on any Linux server, it doesn't\nrequire any additional package installation except if your system do not have\nthe following requirements:\n\n  * Ensure that PostgreSQL binaries are reachable from the '$PATH' environment variable.\n  * Ensure PostgreSQL >= 10.\n  * Ensure that 'PGHOST', 'PGUSER', 'PGPASSWORD' and 'PGDATA' environment variables are defined or use the dedicated command line options (except for 'PGPASSWORD'). Or set a '.pgpass' file in the postgres system account.\n  * Ensure 'sudo apt install crypto-policies' have been run for the FIPS test.\n  * Ensure the Perl bignum module is installed 'perl -e \"use bignum\"', if the command fail, install it using 'dnf install perl-bignum perl-Math-BigRat'.\n  * Ensure the 'curl' command is available and the server have access to Internet. It is used to check the PostgreSQL version online. If this is not possible, use command line option --no-pg-version-check to disable this check.\n  * To view the HTML report you also need an Internet access to obtain the FontAwesome icons used in the Summary Table of security checks.\n\n## INSTALLATION\n\nThe PostgreSQL command psql is used to query the PostgreSQL cluster.\n\nTo install PGDSAT:\n\n    \n    \n    perl Makefile.PL make sudo make install\n\nIf you don't want to install PGDSAT on your system but just want to execute it\nfrom the source directory, follow the instruction at end of next chapter.\n\nSome Linux RPM based distributions do not provide the bignum Perl module by\ndefault, you will need to install it:\n\n    \n    \n    dnf install perl-bignum perl-Math-BigRat\n\n## USAGE\n\nPGSAT use commands to look at the system and especially to the PostgreSQL\ninstallation. It means that it requires the privilege of owner of these\nrepository to be executed. Run it as postgres system user.\n\nUsage: pgdsat [options]\n\n    \n    \n    PostgreSQL Database Security Assessment Tool.\n\nOptions:\n\n    \n    \n    -a | --allow : database to include into the report in parts 4.3 to 4.5. Can be used multiple time and regexp are supported. -d | --database: name of the database to connect to PostgreSQL. -D | --pgdata : path to the PostgreSQL cluster PGDATA to analyze. -e | --exclude : database to exclude from the report in parts 4.3 to 4.5. Can be used multiple time and regexp are supported. -f | --format : output format, can be: text or html. Default: html. -h | --host : PostgreSQL serveur ip address if not listening on localhost -l | --lang : language used for the output (en_US, fr_FR). Default: en_US -o | --output : output file where to write the report. Default stdout. -p | --port : port where PostgreSQL is listening, default: 5432. -P | --psql : full path to the psql command if not found in PATH. -T | --title : set title to use to differentiate the reports. Default is to use \"on `hostname`\". -U | --user : PostgreSQL user to use with the psql command. -v | --version : show version of pgdsat and exist. -V | --cluster : PostgreSQL Cluster version, ex: 15.4. --help : show usage and exit. --no-pg-version-check : disable check for PostgreSQL minor versions. Useful when connecting to Internet is not permitted.\n\nExample:\n\n    \n    \n    pgdsat -U postgres -h localhost -d postgres -o report.html\n\nor pgdsat -U postgres -h localhost -d postgres -f html > report.html\n\nIf you have several PostgreSQL cluster installed you must give the running\nversion that you want to test:\n\n    \n    \n    pgdsat -U postgres -h localhost -d postgres -f html -V 15.4 > report.html\n\nTo execute the pgdsat command locally without installation, use:\n\n    \n    \n    sudo perl -I ./lib ./pgdsat ...\n\n## AUTHORS\n\n  * Gilles Darold.\n\n## LICENSE\n\npgdsat is free software distributed under the GPLv3 license. See LICENCE file\nfor more information.\n\nCopyright (c) 2024 HexaCluster Corp\n\nSome parts are copied from the CIS Benchmark licensed under the Creative\nCommon Version 4.0 terms of use.\n\n## About\n\nPostgreSQL Database Security Assessment Tool\n\n### Resources\n\nReadme\n\n### License\n\nGPL-3.0 license\n\nActivity\n\nCustom properties\n\n### Stars\n\n47 stars\n\n### Watchers\n\n4 watching\n\n### Forks\n\n4 forks\n\nReport repository\n\n## Releases 2\n\nVersion 1.1 Latest\n\nApr 19, 2024\n\n\\+ 1 release\n\n## Packages 0\n\nNo packages published\n\n## Languages\n\n  * Perl 100.0%\n\n## Footer\n\n\u00a9 2024 GitHub, Inc.\n\nYou can\u2019t perform that action at this time.\n\n", "frontpage": false}
