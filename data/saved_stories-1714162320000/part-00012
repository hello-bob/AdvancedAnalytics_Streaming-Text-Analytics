{"aid": "40168837", "title": "Port of Andrjey Karpathy's Llm.c to Mojo", "url": "https://github.com/dorjeduck/llm.mojo", "domain": "github.com/dorjeduck", "votes": 2, "user": "T-A", "posted_at": "2024-04-26 12:52:37", "comments": 0, "source_title": "GitHub - dorjeduck/llm.mojo: port of Andrjey Karpathy's llm.c to Mojo", "source_text": "GitHub - dorjeduck/llm.mojo: port of Andrjey Karpathy's llm.c to Mojo\n\nSkip to content\n\n## Navigation Menu\n\nSign in\n\n# Search code, repositories, users, issues, pull requests...\n\nSearch syntax tips\n\nSign in\n\nSign up\n\nYou signed in with another tab or window. Reload to refresh your session. You\nsigned out in another tab or window. Reload to refresh your session. You\nswitched accounts on another tab or window. Reload to refresh your session.\nDismiss alert\n\ndorjeduck / llm.mojo Public\n\n  * Notifications\n  * Fork 7\n  * Star 115\n\nport of Andrjey Karpathy's llm.c to Mojo\n\n### License\n\nMIT license\n\n115 stars 7 forks Branches Tags Activity\n\nStar\n\nNotifications\n\n# dorjeduck/llm.mojo\n\nThis commit does not belong to any branch on this repository, and may belong\nto a fork outside of the repository.\n\n1 Branch\n\n0 Tags\n\n## Folders and files\n\nName| Name| Last commit message| Last commit date  \n---|---|---|---  \n  \n## Latest commit\n\ndorjeduckupdate test.mdApr 25, 20249003103 \u00b7 Apr 25, 2024Apr 25, 2024\n\n## History\n\n93 Commits  \n  \n### imgs\n\n|\n\n### imgs\n\n| update benchmark, openmd 64 threads| Apr 20, 2024  \n  \n### .gitignore\n\n|\n\n### .gitignore\n\n| gitignore| Apr 22, 2024  \n  \n### LICENSE\n\n|\n\n### LICENSE\n\n| licsense added| Apr 13, 2024  \n  \n### README.md\n\n|\n\n### README.md\n\n| added Mojo version| Apr 23, 2024  \n  \n### prepro_tinyshakespeare.py\n\n|\n\n### prepro_tinyshakespeare.py\n\n| from llm.c| Apr 15, 2024  \n  \n### prepro_tinystories.py\n\n|\n\n### prepro_tinystories.py\n\n| from llm.c| Apr 15, 2024  \n  \n### requirements.txt\n\n|\n\n### requirements.txt\n\n| add requirements.txt| Apr 18, 2024  \n  \n### test.md\n\n|\n\n### test.md\n\n| update test.md| Apr 25, 2024  \n  \n### test_gpt2.mojo\n\n|\n\n### test_gpt2.mojo\n\n| to_int() -> int( )| Apr 22, 2024  \n  \n### train_gpt2.mojo\n\n|\n\n### train_gpt2.mojo\n\n| update parallize| Apr 23, 2024  \n  \n### train_gpt2.py\n\n|\n\n### train_gpt2.py\n\n| add download weights script| Apr 15, 2024  \n  \n### train_gpt2_basic.mojo\n\n|\n\n### train_gpt2_basic.mojo\n\n| to_int() -> int( )| Apr 22, 2024  \n  \n### usage_instructions.md\n\n|\n\n### usage_instructions.md\n\n| added Mojo version| Apr 23, 2024  \n  \n## Repository files navigation\n\n# llm.\ud83d\udd25\n\nThis project is a port of Andrej Karpathy's llm.c to Mojo, currently in beta.\nIt is under active development and subject to changes. Users should expect to\nencounter bugs and unfinished features.\n\n## Implementation\n\n  * train_gpt2_basic.mojo: Basic port of train_gpt2.c to Mojo, which does not leverage Mojo's capabilities. Beyond the initial commit, we will not provide further updates for the 'train_gpt2_basic' version, except for necessary bug fixes.\n  * train_gpt2.mojo: Enhanced version utilizing Mojo's performance gems like vectorization and parallelization. Work in progress.\n\n## How to use\n\nVisit llm.c for a detailed explanation of the original project.\n\nEnsure that you have Mojo version 24.2.1 installed. To use llm.mojo, run:\n\n    \n    \n    pip install -r requirements.txt python prepro_tinyshakespeare.py python train_gpt2.py mojo train_gpt2.mojo\n\nFor a more detailed step-by-step guide including additional setup details and\noptions, please refer to our detailed usage instructions.\n\n## Benchmarks\n\nPreliminary benchmark results: (M2 MacBook Pro)\n\n  * We are running the OpenMP-enabled train_gpt2.c with 64 threads. (OMP_NUM_THREADS=64 ./train_gpt2)\n\nImplementation| Average Training Loop Time  \n---|---  \ntrain_gpt2.mojo| 1819 ms  \ntrain_gpt2.c (with OpenMP)| 1849 ms  \ntrain_gpt2.c (no OpenMP)| 7473 ms  \ntrain_gpt2_basic.mojo| 54509 ms  \n  \n## Test\n\nWe ported test_gpt2.c from the original repository to Mojo to validate our\nport's functionality. For instructions on how to run this test and insights\ninto the results it yields, please see our guide here.\n\n## Development Roadmap\n\n  * Implementation Improvement: Enhance train_gpt.mojo to fully exploit Mojo's capabilities, including further optimization for speed and efficiency.\n  * Following Changes of llm.c: Regularly update the Mojo port to align with the latest improvements and changes made to llm.c.\n  * Solid Benchmarks: Develop comprehensive and reliable benchmarks to accurately measure performance improvements and compare them against other implementations.\n\n## Changelog\n\n  * 2024.04.20\n\n    * Further optimization (utilizing unroll_factor of vectorize)\n  * 2024.04.19\n\n    * test_gpt2.mojo added.\n  * 2024.04.18\n\n    * Upgraded project status to Beta.\n    * Further optimizations of train_gpt2.mojo.\n  * 2024.04.16\n\n    * Vectorize parameter update\n  * 2024.04.15\n\n    * Tokenizer Added - train_gpt2.c Update 2024.04.14\n    * Bug fix attention_backward\n  * 2024.04.13\n\n    * Initial repository setup and first commit.\n\n## License\n\nMIT\n\n## About\n\nport of Andrjey Karpathy's llm.c to Mojo\n\n### Resources\n\nReadme\n\n### License\n\nMIT license\n\nActivity\n\n### Stars\n\n115 stars\n\n### Watchers\n\n3 watching\n\n### Forks\n\n7 forks\n\nReport repository\n\n## Releases\n\nNo releases published\n\n## Packages 0\n\nNo packages published\n\n## Contributors 3\n\n  * dorjeduck Martin Dudek\n  * dagelf Coenraad Loubser\n  * raffenet Ken Raffenetti\n\n## Languages\n\n  * Mojo 83.1%\n  * Python 16.9%\n\n## Footer\n\n\u00a9 2024 GitHub, Inc.\n\nYou can\u2019t perform that action at this time.\n\n", "frontpage": false}
