{"aid": "40291676", "title": "Island ECN FoxPro Source Code", "url": "http://www.josh.com/notes/island-ecn-10th-birthday/", "domain": "josh.com", "votes": 1, "user": "indigodaddy", "posted_at": "2024-05-07 21:24:28", "comments": 0, "source_title": "Island ECN 10th Birthday Source Code Release!", "source_text": "Island ECN 10th Birthday Source Code Release!\n\n# Island ECN 10th Birthday Source Code Release!\n\nIn honor of Island's tenth birthday, I am releasing the source code to the\nFoxpro matching engine as it appeared on 12/15/2003. This was the last version\nbefore the Java migration. While the Java version is some *very* nice code,\nand ran several orders of magnitude faster - this code it particularly\ninteresting precisely because it ran on such a slow platform and is so easy to\nread, highlighting the idea that it is usually the architecture and algorithms\nthat matter more then raw platform speed.\n\nYou can view the full source code here, but the only part that really matters\nis that actual matching engine, which is the enter2order procedure. To\nparaphrase...\n\n  1. See if there was a record from a recently canceled order that we can reuse for this new order. This is hugely important because that record will likely still be in the cache and using it will be *much* faster than making a new one.\n  2. Generate the sequence number and timestamp for the new order.\n  3. If a minimum quantity was specified, check to see if this order could potentially be filled. If not, skip the matching part and give a U R Out.\n  4. If this is a round lot only order, again check if it could possibly be filled and give a U R Out if not.\n  5. Start matching! Starting at the top of the book until we either run out of shares or orders to match against.\n  6. Give a U R Out for any unexecuted shares.\n\nThat's it! The while thing is less than a page long, and is twice as long as\nnecessary because the buy and sell paths are repeated for clarity. No magic\nhere - simple is best.\n\n## FAQ:\n\nQ: But wait, what about all the messaging and sequencing and indexing? A: This\ncode is only the matching engine, which sits on top of plenty of other support\nsoftware. All the networking and message sequencing code is written in hard\ncode C and ASM. Any place you see INT97that is a call down to this code. But\nthat is just plumbing. This also depends on FoxPro's ISAM indexing engine\nwhich uses a B*tree and is still impressive in its performance and reliability\neven 20 years later. Any place you see a SEEK, that is a call down to the\nFoxPro indexer.\n\nQ: What the hell kind of code is that? A: FoxPro for DOS version 2.6! Make fun\nif you want, but neither Linux nor Windows can hold a candle to MSDOS for\nreliability. I had DOS machines that were running continuously from 1992 until\n2010. When I finally shut them down to move them to virtual machines, I found\nout that their hard drives and BIOS batteries were long dead, but that didn't\nstop them! See how long a Windows or Linux machine can run with a dead hard\ndrive...\n\nQ: 10th birthday? How are you counting? A: I am counting from the day that\nIsland2 went live with real stocks. Island2 was the second design of the\nmatching engine and was different than Island1 (at the time just Island)\nbecause the first design was built on top of NASDAQ's SelectNet system. BTW,\nthe first version wen live on 2/9/96.\n\nQ: How is this code fault tolerant? A: It isn't. The fault tolerance came from\nthe fact there were always (at least) two copies of this program in different\nplaces on physically separate networks. If one machine (or network, or data\ncenter) died, you'd just promote the other one and everything would continue\non from where it left off. I am a big fan of this shared-nothing strategy and\nam shocked at how many systems in the world say they are fault tolerant when\nthey really are just moving the single point of failure somewhere else.\n\n## UPDATES\n\n4/22/2011: I just saw an old friend who now works at NASDAQ and he told me\nthat the \"Jerkboy\" messages still come up in NASDAQ's error logs!!!!! The code\nlives after 15+ years!\n\n9/22/2011: Added an old logo image I found.\n\n###\n\n", "frontpage": false}
