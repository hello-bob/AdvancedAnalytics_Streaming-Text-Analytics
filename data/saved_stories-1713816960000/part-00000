{"aid": "40113536", "title": "Speculative decoding of llama2 models in pure C", "url": "https://github.com/mscheong01/speculative_decoding.c", "domain": "github.com/mscheong01", "votes": 1, "user": "mscheong", "posted_at": "2024-04-22 12:05:32", "comments": 0, "source_title": "GitHub - mscheong01/speculative_decoding.c: minimal C implementation of speculative decoding based on llama2.c", "source_text": "GitHub - mscheong01/speculative_decoding.c: minimal C implementation of\nspeculative decoding based on llama2.c\n\nSkip to content\n\nSign in\n\n# Search code, repositories, users, issues, pull requests...\n\nSearch syntax tips\n\nSign in\n\nSign up\n\nYou signed in with another tab or window. Reload to refresh your session. You\nsigned out in another tab or window. Reload to refresh your session. You\nswitched accounts on another tab or window. Reload to refresh your session.\nDismiss alert\n\nmscheong01 / speculative_decoding.c Public\n\n  * Notifications\n  * Fork 0\n  * Star 3\n\nminimal C implementation of speculative decoding based on llama2.c\n\n### License\n\nMIT license\n\n3 stars 0 forks Branches Tags Activity\n\nStar\n\nNotifications\n\n# mscheong01/speculative_decoding.c\n\nThis commit does not belong to any branch on this repository, and may belong\nto a fork outside of the repository.\n\n1 Branch\n\n0 Tags\n\n## Folders and files\n\nName| Name| Last commit message| Last commit date  \n---|---|---|---  \n  \n## Latest commit\n\nmscheong01Update README.mdApr 22, 20248233d1d \u00b7 Apr 22, 2024Apr 22, 2024\n\n## History\n\n4 Commits  \n  \n### .gitignore\n\n|\n\n### .gitignore\n\n| initial commit| Apr 22, 2024  \n  \n### License\n\n|\n\n### License\n\n| initial commit| Apr 22, 2024  \n  \n### Makefile\n\n|\n\n### Makefile\n\n| initial commit| Apr 22, 2024  \n  \n### README.md\n\n|\n\n### README.md\n\n| Update README.md| Apr 22, 2024  \n  \n### image.png\n\n|\n\n### image.png\n\n| initial commit| Apr 22, 2024  \n  \n### run.c\n\n|\n\n### run.c\n\n| initial commit| Apr 22, 2024  \n  \n### speculative_decoding.c\n\n|\n\n### speculative_decoding.c\n\n| initial commit| Apr 22, 2024  \n  \n### tokenizer.bin\n\n|\n\n### tokenizer.bin\n\n| initial commit| Apr 22, 2024  \n  \n## Repository files navigation\n\n# speculative_decoding.c\n\nminimal C implementation of speculative decoding on llama2 model.\n\nSpeculative decoding is a technique used to speed up autoregressive inference\nusing a lightweight draft model. This project demonstrates this approach with\nsimple pure C code.\n\nwhat I basically did was fix the llama2.c/run.c file to support forwarding\nmultiple tokens and implemented speculative_decoding.c using that.\n\nSpecial thanks to:\n\n@karpathy for providing llama2.c as a starting point and inspiration for this\nproject\n\n  * llama2.c/run.c was copied along with license notations to this project.\n\n@ggerganov for writing llama.cpp where I initially got the oppertunity to\nstudy and code spec-dec related stuff\n\n## How to use\n\n  1. download base/draft models\n\n    \n    \n    wget https://huggingface.co/karpathy/tinyllamas/resolve/main/stories15M.bin wget https://huggingface.co/karpathy/tinyllamas/resolve/main/stories42M.bin\n\n  2. build and run\n\n    \n    \n    make && ./speculative_decoding -m ./models/stories42M.bin -d ./models/stories15M.bin -n 256 -i \"Once upon a time\"\n\n### Meta llama2 models:\n\nto use llama2 models, follow the description written in llama2.c\n\n## References\n\n    \n    \n    @inproceedings{leviathan2023fast, title={Fast inference from transformers via speculative decoding}, author={Leviathan, Yaniv and Kalman, Matan and Matias, Yossi}, booktitle={International Conference on Machine Learning}, pages={19274--19286}, year={2023}, organization={PMLR} }\n\n## some known issues\n\n  * The generation is constrained by the maximum sequence length of the draft model. Consequently, employing lengthy generation with speculative decoding is unfeasible with the current setup, when utilizing a draft model with a short maximum sequence length.\n\n## License\n\nMIT\n\nI added the original copyright notice to the copied run.c file. Please let me\nknow if I made any mistakes with the licensing.\n\n## ETC\n\nAny sort of feedback is very welcome :)\n\nMore speculative-decoding related C implementations are to come!\n\nI'm thinking of https://github.com/SafeAILab/EAGLE next.\n\n## About\n\nminimal C implementation of speculative decoding based on llama2.c\n\n### Topics\n\nc artificial-intelligence llm llama2 speculative-decoding\n\n### Resources\n\nReadme\n\n### License\n\nMIT license\n\nActivity\n\n### Stars\n\n3 stars\n\n### Watchers\n\n1 watching\n\n### Forks\n\n0 forks\n\nReport repository\n\n## Languages\n\n  * C 99.7%\n  * Makefile 0.3%\n\n## Footer\n\n\u00a9 2024 GitHub, Inc.\n\nYou can\u2019t perform that action at this time.\n\n", "frontpage": false}
