{"aid": "40111009", "title": "Terraform-AWS-Nuke-Bomber", "url": "https://github.com/masterpointio/terraform-aws-nuke-bomber", "domain": "github.com/masterpointio", "votes": 1, "user": "mooreds", "posted_at": "2024-04-22 02:35:39", "comments": 0, "source_title": "GitHub - masterpointio/terraform-aws-nuke-bomber: :airplane: :cloud: A Terraform module to create a bomber which nukes your cloud environment on a schedule", "source_text": "GitHub - masterpointio/terraform-aws-nuke-bomber: :airplane: :cloud: A\nTerraform module to create a bomber which nukes your cloud environment on a\nschedule\n\nSkip to content\n\nSign in\n\n# Search code, repositories, users, issues, pull requests...\n\nSearch syntax tips\n\nSign in\n\nSign up\n\nYou signed in with another tab or window. Reload to refresh your session. You\nsigned out in another tab or window. Reload to refresh your session. You\nswitched accounts on another tab or window. Reload to refresh your session.\nDismiss alert\n\nmasterpointio / terraform-aws-nuke-bomber Public\n\n  * Notifications\n  * Fork 3\n  * Star 19\n\n\u2708\ufe0f \ud83d\udca3 \u2601\ufe0f A Terraform module to create a bomber which nukes your cloud\nenvironment on a schedule\n\nmasterpoint.io\n\n### License\n\nMIT license\n\n19 stars 3 forks Branches Tags Activity\n\nStar\n\nNotifications\n\n# masterpointio/terraform-aws-nuke-bomber\n\nThis commit does not belong to any branch on this repository, and may belong\nto a fork outside of the repository.\n\n1 Branch\n\n2 Tags\n\n## Folders and files\n\nName| Name| Last commit message| Last commit date  \n---|---|---|---  \n  \n## Latest commit\n\nGowiemMerge pull request #2 from masterpointio/dependabot/add-v2-config-\nfileJun 11, 20213a78578 \u00b7 Jun 11, 2021Jun 11, 2021\n\n## History\n\n25 Commits  \n  \n### .github\n\n|\n\n### .github\n\n| Upgrade to GitHub-native Dependabot| Apr 29, 2021  \n  \n### examples/complete\n\n|\n\n### examples/complete\n\n| Updates to require region + AZs variables| Apr 25, 2020  \n  \n### .gitignore\n\n|\n\n### .gitignore\n\n| Adds nuke-config to gitignore. Will use nuke-config.example| Apr 22, 2020  \n  \n### Dockerfile\n\n|\n\n### Dockerfile\n\n| Updates to use --force flag > expect script| Apr 25, 2020  \n  \n### LICENSE\n\n|\n\n### LICENSE\n\n| Initial commit| Apr 20, 2020  \n  \n### Makefile\n\n|\n\n### Makefile\n\n| Updates Makefile so push and tag don't do previous steps| Apr 25, 2020  \n  \n### README.md\n\n|\n\n### README.md\n\n| Updates project call outs with orgs| Apr 30, 2020  \n  \n### main.tf\n\n|\n\n### main.tf\n\n| Updates project call outs with orgs| Apr 30, 2020  \n  \n### nuke-config.yml.example\n\n|\n\n### nuke-config.yml.example\n\n| Updates to nuke-config example pattern| Apr 22, 2020  \n  \n### outputs.tf\n\n|\n\n### outputs.tf\n\n| Adds SG egress, ecr URL output, updates cmd| Apr 21, 2020  \n  \n### variables.tf\n\n|\n\n### variables.tf\n\n| Disables NAT Gateways| Apr 25, 2020  \n  \n## Repository files navigation\n\n# terraform-aws-nuke-bomber\n\n\u2708\ufe0f \ud83d\udca3 \u2601\ufe0f\n\nThis terraform module deploys a VPC, ECS Cluster, and Scheduled ECS Fargate\nTask to repeatedly execute aws-nuke, which removes all resources in the given\nAWS Account. This is intended for usage in \"Test Accounts\" where developers or\nCI / CD are typically deploying infrastructure that needs to be cleaned up\noften, otherwise it would incur unnecessary costs.\n\n##### NOTE: As is stated multiple times on the aws-nuke repo, this project\nshould similarly be used with extreme caution for obvious reasons. You should\nexplicitly add all AWS Account IDs that you don't want nuked to the exclude\nsection of your nuke-config.yml file and be sure to properly configure the\nfilters in that same file to keep around any resources which you don't want\nremoved. Always run this project in dry-run mode first (on by default) and\nonly override the terraform command variable to use --no-dry-run once you've\nensured everything is running properly. This project and its maintainers are\nnot responsible for not following those steps.\n\nBig shout out to the following projects which this project uses/depends on!\n\n  1. rebuy-de/aws-nuke\n  2. cloudposse/terraform-null-label\n  3. cloudposse/terraform-aws-vpc\n  4. cloudposse/terraform-aws-dynamic-subnets\n  5. cloudposse/terraform-aws-ecs-container-definition\n\n## Usage\n\nFirst, deploy the module:\n\n    \n    \n    provider \"aws\" { region = \"us-east-1\" } module \"nuke_bomber\" { source = \"git::https://github.com/masterpointio/terraform-aws-nuke-bomber.git?ref=tags/0.1.0\" namespace = var.namespace # NOTE: 5 minutes is way too often. This is just for testing / example purposes. # Change this once you're not running drills! schedule_expression = \"rate(5 minutes)\" }\n\nNext, to get the ECS Task running, you need to do the following:\n\n  1. Clone this repo and change into this directory:\n\n     * git clone git@github.com:masterpointio/terraform-aws-nuke-bomber.git && cd terraform-aws-nuke-bomber\n  2. Copy nuke-config example:\n\n     * cp nuke-config.yml.example nuke-config.yml\n  3. Replace your nuke-config.yml TODO_ fields with your Account ID, Region, and Production Account ID(s).\n  4. Check over the config. Make sure to exclude or filter out anything you don't want removed from your account!\n  5. From your terraform project direct, grab the ECR Repo URL from the terraform output:\n\n     * export ECR_REPO=$(terraform output ecr_repo_url)\n  6. Make sure you've got an ECR Push token via:\n\n     * eval $(aws ecr get-login --region us-east-1 --no-include-email)\n  7. Build, tag, and push the Docker image:\n\n     * make\n  8. Check out your logs in CloudWatch to watch the bomb drop!\n\nNoticed that nothing got deleted even though your bomber should've nuked the\naccount? That was just a drill... update your nuke_bomber module with the\nfollowing and terraform apply the change to fire for effect:\n\n    \n    \n    module \"nuke_bomber\" { source = \"git::https://github.com/masterpointio/terraform-aws-nuke-bomber.git?ref=tags/0.1.0\" namespace = var.namespace command = [\"-c\", \"/home/aws-nuke/nuke-config.yml\", \"--force\", \"--force-sleep\", \"3\", \"--no-dry-run\"] schedule_expression = \"rate(48 hours)\" }\n\n## Requirements\n\nName| Version  \n---|---  \nterraform| >= 0.12  \naws| ~> 2.0  \n  \n## Providers\n\nName| Version  \n---|---  \naws| ~> 2.0  \n  \n## Inputs\n\nName| Description| Type| Default| Required  \n---|---|---|---|---  \nattributes| Additional attributes (e.g. 1)| list(string)| []| no  \navailability_zones| List of Availability Zones where subnets will be created.|\nlist(string)| n/a| yes  \ncommand| The CMD to execute on the ECS container. Override this to actually\nexecute the nuke.| list(string)|\n\n    \n    \n    [ \"-c\", \"/home/aws-nuke/nuke-config.yml\", \"--force\", \"--force-sleep\", \"3\" ]\n\n| no  \ncontainer_cpu| The container's CPU for the bomber task.| number| 256| no  \ncontainer_memory| The container's memory for the bomber task.| number| 512| no  \ncontainer_memory_reservation| The container's memory reservation for the\nbomber task.| number| 512| no  \ndelimiter| Delimiter to be used between namespace, stage, name and attributes|\nstring| \"-\"| no  \nenvironment| Environment, e.g. 'prod', 'staging', 'dev', 'pre-prod', 'UAT'|\nstring| \"\"| no  \nlog_retention_in_days| The number of days to retain the bomber task logs.|\nnumber| 30| no  \nname| Solution name, e.g. 'app' or 'jenkins'| string| \"bomber\"| no  \nnamespace| Namespace, which could be your organization name or abbreviation,\ne.g. 'eg' or 'cp'| string| n/a| yes  \nnat_gateway_enabled| Whether to enable NAT Gateways. If false, then the\napplication uses NAT Instances, which are much cheaper.| bool| false| no  \nregion| The AWS Region to deploy these resources to.| string| n/a| yes  \nschedule_expression| The expression to determine the schedule on which to\ninvoke the bomber. Useful information @\nhttps://docs.aws.amazon.com/AmazonCloudWatch/latest/events/ScheduledEvents.html.|\nstring| \"rate(24 hours)\"| no  \nstage| The environment that this infrastrcuture is being deployed to e.g. dev,\nstage, or prod| string| \"nuke\"| no  \ntags| Additional tags (e.g. map('BusinessUnit','XYZ')| map(string)| {}| no  \nvpc_cidr_block| The CIDR block used for the VPC network.| string|\n\"10.0.0.0/16\"| no  \n  \n## Outputs\n\nName| Description  \n---|---  \necr_repo_url| The URL of the ECR Repo to push your docker image to.  \n  \n## About\n\n\u2708\ufe0f \ud83d\udca3 \u2601\ufe0f A Terraform module to create a bomber which nukes your cloud\nenvironment on a schedule\n\nmasterpoint.io\n\n### Topics\n\naws terraform ecs terraform-module fargate\n\n### Resources\n\nReadme\n\n### License\n\nMIT license\n\nActivity\n\nCustom properties\n\n### Stars\n\n19 stars\n\n### Watchers\n\n4 watching\n\n### Forks\n\n3 forks\n\nReport repository\n\n## Releases\n\n2 tags\n\n## Packages 0\n\nNo packages published\n\n## Contributors 2\n\n  * Gowiem Matt Gowie\n  * dependabot-preview[bot]\n\n## Languages\n\n  * HCL 95.9%\n  * Makefile 2.8%\n  * Dockerfile 1.3%\n\n## Footer\n\n\u00a9 2024 GitHub, Inc.\n\nYou can\u2019t perform that action at this time.\n\n", "frontpage": false}
