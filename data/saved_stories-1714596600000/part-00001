{"aid": "40224032", "title": "Takeaways from Tailscale's Adoption of ARI at Let's Encrypt", "url": "https://letsencrypt.org/2024/05/01/ari-in-tailscale.html", "domain": "letsencrypt.org", "votes": 1, "user": "SGran", "posted_at": "2024-05-01 14:48:15", "comments": 0, "source_title": "Takeaways from Tailscale\u2019s Adoption of ARI", "source_text": "Takeaways from Tailscale\u2019s Adoption of ARI - Let's Encrypt\n\nSkip navigation links\n\n# Takeaways from Tailscale\u2019s Adoption of ARI\n\nMay 1, 2024 \u2022 Sarah McClure (Let\u2019s Encrypt) & Andrew Lytvynov (Tailscale)\n\nSince March 2023, Let\u2019s Encrypt has been improving our resiliency and\nreliability via ACME Renewal Information (ARI). ARI makes it possible for our\nSubscribers to handle certificate revocation and renewal easily and\nautomatically. A primary benefit of ARI is that it sets Subscribers up for\nsuccess in terms of ideal renewal times in the event that Let\u2019s Encrypt offers\ncertificates with even shorter lifetimes than 90 days. We recently published a\nguide for engineers on how to integrate ARI into existing ACME Clients.\n\nIn this blog post, we\u2019ll explore Let\u2019s Encrypt Subscriber Tailscale\u2019s\nexperience adopting ARI.\n\nIn total, it took just two Tailscale engineers less than two days to implement\nARI. Prior to ARI, the Tailscale team had made other iterations of cert\nrenewal logic, including hardcoding renewal 14 days before expiry and\nhardcoding 1/3rd of remaining time until expiry. An issue with these\napproaches was that assumptions were made about the validity period of\ncertificates issued by Let\u2019s Encrypt, which will change in the future. In\ncontrast, ARI allows Tailscale to offload the renewal decision to Let\u2019s\nEncrypt without making any assumptions.\n\nTailscale noted that ARI was especially useful to add before certificates'\nvalidity period starts shortening, as their client software in charge of\nrequesting and renewing certificates is running on user machines. This makes\nit so they cannot easily update the whole fleet overnight if any issues come\nup. Thanks to ARI, they\u2019ve reduced the risk of not rotating certificates for\nclient machines in time, or causing excessive load on Let\u2019s Encrypt\u2019s\ninfrastructure with overly-eager rotation logic.\n\nOne consideration the Tailscale team factored in deciding to adopt ARI was\nwanting to avoid adding a hard dependency on the Let\u2019s Encrypt infrastructure\nfor renewal. To remedy this, Tailscale certificate renewal logic falls back to\nlocal time-based check if the ARI endpoint cannot be reached for any reason.\n\nTailscale\u2019s roadmap for getting ARI in production:\n\n  * Updated their fork of golang.org/x/crypto to support ARI\n\n  * Updated the renewal code in the Tailscale client\n\n  * Tested it locally by requesting certificates for a dev domain\n\n  * Tested renewal by stubbing out ARI response with hardcoded data\n\n  * Tested fallback by blocking ARI requests\n\n  * Shipped it!\n\nThe team reported running into one snag during the process. Because the RFC is\nnot finalized, the upstream Go package for ACME doesn\u2019t support ARI yet. As a\nsolution, they added support in their fork of that Go package. Tailscale\u2019s\nmain piece of advice for Subscribers adopting ARI: don\u2019t forget to put a\ntimeout on your ARI request!\n\nWe\u2019re grateful to the Tailscale team for taking the time to share with us\ntheir experience adopting ARI and advice for fellow Subscribers. In addition\nto being an ARI adopter, Tailscale is a Let\u2019s Encrypt Sponsor! We appreciate\ntheir support of our work to build a more secure Web.\n\nWe\u2019re also grateful to be partnering with Princeton University on our ACME\nRenewal Information work, thanks to generous support from the Open Technology\nFund.\n\nInternet Security Research Group (ISRG) is the parent organization of Let\u2019s\nEncrypt, Prossimo, and Divvi Up. ISRG is a 501(c)(3) nonprofit. If you\u2019d like\nto support our work, please consider getting involved, donating, or\nencouraging your company to become a sponsor.\n\n## Support a more secure and privacy-respecting Web.\n\nDonate\n\nLet's Encrypt is a free, automated, and open certificate authority brought to\nyou by the nonprofit Internet Security Research Group (ISRG). Read all about\nour nonprofit work this year in our 2023 Annual Report.\n\n548 Market St, PMB 77519, San Francisco, CA 94104-5401, USA\n\nSend all mail or inquiries to:\n\nPO Box 18666, Minneapolis, MN 55418-0666, USA\n\n  * GitHub\n  * Twitter\n  * Mastodon\n\nView our privacy policy. View our trademark policy.\n\n###### Subscribe to our Newsletter\n\n", "frontpage": false}
