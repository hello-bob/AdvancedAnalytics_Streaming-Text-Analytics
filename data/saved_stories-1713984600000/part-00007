{"aid": "40141843", "title": "ManMan (2020)", "url": "https://wooz.dev/ManMan", "domain": "wooz.dev", "votes": 1, "user": "todsacerdoti", "posted_at": "2024-04-24 08:05:24", "comments": 0, "source_title": "ManMan - Woozle Writes Code", "source_text": "ManMan - Woozle Writes Code\n\n# ManMan\n\nFrom Woozle Writes Code\n\nJump to navigation Jump to search\n\nWhen I worked for Carrier Transicold, they used an ancient DEC-based\nenterprise business package called \"ManMan\".\n\nIt was written (as with most DEC stuff) for TTY terminals, and didn't know\nanything about modern newfangled relational databases.\n\nAs the PC era gradually edged its way into the front office, people started\nwriting their own little data apps in MS Access, some of which used various\nkluges to grab bits of data out of ManMan. Some of them were in Access 7 and\nsome were in Access 2, and they used different methods for talking to the DEC\nmachine, and some were reliable and some had to be babied by their authors\nmuch of the time... you get the idea.\n\nBy the time I came on board, there were maybe a couple dozen of these apps,\nand very little documentation of how any of them worked or what they were\nsupposed to do \u2013 but it was clear that they were being used regularly, and\n(especially given the increasing number of times IT had to be called in to fix\none or another of them) that front office operations depended on them heavily.\n\nSo one large part of this was what we called the Augean Stables project:\ndocument the intended purpose of each of these apps, look for any redundancy,\ny2k-remediate them (y2k remediation was, I think, the reason we got clearance\nto do any of this cleanup), and get them working according to spec.\n\nA large part of that was coming up with a reliable and maintainable way for\nthem to talk to the ManMan server.\n\nMostly, the existing apps had been using this weird super-powered smart-\nterminal app that had its own BASIC-like scripting feature and communicating\nwith it via DDE (a weird old Windows protocol). So we had bits of code in\nthree different formats: VBA (Visual Basic for Applications), DDE commands,\nand the terminal's version of BASIC. It was a huge mess.\n\nI figured out, though, that all the terminal app really needed to do was\nenable direct communication between VBA and ManMan, and that this could be\ndone via a standard ActiveX control which was basically a dumb TCP/IP socket.\nAll of the scripts could be rewritten in VBA, and the DDE could go away.\n\nThe tricky part was making sure that requests to the DEC machine were handled\nin some kind of verifiable manner -- so we would know, say, if one app was\nhaving a problem getting its data back, and we could answer questions like\n\"what's the current turnaround time on ManMan requests?\"\n\nSo we wrote this sort-of-elaborate-but-conceptually-simple request-and-\nresponse queueing system, to handle requests from all the different apps,\nscrape the various ManMan screens in a systematic way, and return the data in\nnormalized MS Access tables.\n\nWe called the system \"Socket to the ManMan\".\n\nRetrieved from \"https://wooz.dev/mw/index.php?title=ManMan&oldid=265\"\n\nCategory:\n\n  * Stories\n\n## Navigation menu\n\n  * This page was last edited on 18 January 2020, at 01:44.\n  * Content is available under Creative Commons Attribution-NonCommercial-ShareAlike unless otherwise noted.\n\n  * Privacy policy\n  * About Woozle Writes Code\n  * Disclaimers\n\n", "frontpage": false}
