{"aid": "40051264", "title": "The Origin Story [for Xmit.co]", "url": "https://xmit.dev/posts/origin/", "domain": "xmit.dev", "votes": 2, "user": "ptramo", "posted_at": "2024-04-16 12:49:52", "comments": 0, "source_title": "The origin story", "source_text": "The origin story\n\n# The origin story\n\nfrom 2024-04-12\n\nHost static sites. Sounds trivial, right?\n\nHere are details worth considering, whether you host on your own servers or\nrely on a platform like the one we're building.\n\n## Security: full HTTPS, HSTS, headers galore\n\nSecuring all traffic is a no-brainer.\n\nAll HTTP traffic is redirected to HTTPS, and we include HSTS headers\neverywhere.\n\nWe go a bit further, with referrer-policy: no-referrer, x-content-type-\noptions: nosniff, x-frame-options: SAMEORIGIN out of the box.\n\n## Admin: 2 clicks to sign up or sign in, everything in real time\n\nWe've been there: the latest launch is broken, a rollback is in order.\n\nWe've made it as fast and simple as possible, and as with any launch, it's\neffective across our infrastructure in milliseconds.\n\nAnd to make sure wires don't get crossed, the entire admin console is fully\nreactive.\n\n## Uploads: only what's changed\n\nxmit is smart enough to only upload files that have changed. It's open source\n(0BSD license), so you can inspect the details. In short, it generates a\nmanifest of all file hashes, uploads it only if it's new (checked by hash),\nthen uploads only files whose hashes are new.\n\n## Safe launches: atomicity & fallthrough\n\nWith atomic launches, it's all or nothing, and within the milliseconds of\npropagation delays of our coordination system (etcd). A client won't see HTML\nreferring to a new JS/CSS/asset until it's been made available on its\nconnection, avoiding a common source of 404s.\n\nTo fully avoid 404s, previous launches also need to be excluded slowly:\nservers need to fall through, so a client which loaded HTML just before a\nlaunch, which referred to JS/CSS/assets not included in said launch, still\ngets enough chances to load them (today, over 5 launches and 10 minutes, such\nthat removing a resource propagates consistently within an short window).\n\n## xmit subdomains: every upload is visible to your team\n\nEvery upload can be accessed through a dedicated xmit subdomain, letting you\nvet it before launch if you didn't enable launch on upload. Those subdomains\nare only accessible to your team. They stick around, so it's easy to check\nwhat was online at any point in recent history.\n\n## Protocols: HTTP/1.1, HTTP/2, & H3\n\nHTTP/2 was a leap forward. QUIC is another.\n\nWe support both, announced through DNS HTTPS records and Alt-Svc headers.\n\n## accept-ranges: bytes\n\nResume downloads, play videos in Safari, and more. We support range requests\nand advertise it to clients.\n\n## Compression: gzip whenever worthwhile\n\nRather than hardcode a list of extensions or MIME types worthy of compression,\nwe give it a go on everything, and use the compressed version when requested\nand smaller.\n\n## Caching: ETag & if-none-match\n\nna Our servers only rely on content-addressible caching. Browsers cache URLs.\n\nWe do not introduce any propagation delays in CDNs, proxies, or browser caches\nother than through headers you control.\n\nBut if the browser saw a resource already, no reason to transfer it again.\nThat's where ETag comes in. We always report one, and return 304 Not Modified\nif it appears in the if-none-match header received from clients.\n\n## www subdomain\n\nUnless you launch a site there, we redirect www to its parent domain for you.\n\n## No need for a subdirectory per page\n\nName your page hello.html and access it at /hello. Simple and practical.\n\n## Just enough config\n\nxmit.toml, which isn't served, offers simple settings. For example:\n\n    \n    \n    fallback = \"index.html\" # for Single Page Apps 404 = \"404.html\" # for custom 404 pages (none in SPAs) [[headers]] # add a CORS header name = \"access-control-allow-origin\" value = \"*\" [[headers]] # unset \"referrer-policy\" name = \"referrer-policy\" [[headers]] # cache assets for a year name = \"cache-control\" value = \"public, max-age=31536000\" on = \"/assets/.*\" [[redirects]] from = \"/new/(.*)\" to = \"/$1\" permanent = true # 301 instead of 307\n\nWe make xmit.co.\n\n", "frontpage": false}
