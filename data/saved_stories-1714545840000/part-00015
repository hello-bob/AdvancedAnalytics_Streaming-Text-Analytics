{"aid": "40215616", "title": "How to Block Residential Proxies Using Okta", "url": "https://sec.okta.com/blockanonymizers/", "domain": "okta.com", "votes": 2, "user": "doener", "posted_at": "2024-04-30 20:01:33", "comments": 0, "source_title": "How to Block Residential Proxies using Okta", "source_text": "How to Block Residential Proxies using Okta | Okta Security\n\nSecurity\n\nGo to Okta.com \u2197\n\n\u2039 Back to blog\n\nApril 27, 2024\n\n# How to Block Residential Proxies using Okta\n\nMoussa Diallo and Brett Winterford\n\nSummary: Every customer using the Workforce Identity Cloud and Customer\nIdentity Solution can now block access requests originating from residential\nproxies prior to authentication.\n\nOver the last month, Okta has observed an increase in the frequency and scale\nof credential stuffing attacks targeting online services, facilitated by the\nbroad availability of residential proxy services, lists of previously stolen\ncredentials (\u201ccombo lists\u201d), and scripting tools.\n\n  * From March 18, 2024 through to April 16, 2024, Duo Security and Cisco Talos observed large-scale brute force attacks on multiple models of VPN devices.\n  * From April 19, 2024 through to April 26, 2024, Okta\u2019s Identity Threat Research team observed a spike in credential stuffing activity against user accounts from what appears to be similar infrastructure.\n\nIn credential stuffing attacks, adversaries attempt to sign-in to online\nservices using large lists of usernames and passwords obtained from previous\ndata breaches of unrelated entities, or from phishing or malware campaigns.\n\nAll recent attacks we have observed share one feature in common: they rely on\nrequests being routed through anonymizing services such as TOR. Millions of\nthe requests were also routed through a variety of residential proxies\nincluding NSOCKS, Luminati and DataImpulse.\n\n## What are Residential Proxies?\n\nResidential Proxies are networks of legitimate user devices that route traffic\non behalf of a paid subscriber. Providers of residential proxies effectively\nrent access to route authentication requests through the computer, smartphone\nor router of a real user, and proxy traffic through the IP of these devices to\nanonymize the source of the traffic.\n\nResidential Proxy providers don\u2019t tend to advertise how they build these\nnetworks of real user devices. Sometimes a user device is enrolled in a proxy\nnetwork because the user consciously chooses to download \u201cproxyware\u201d into\ntheir device in exchange for payment or something else of value. At other\ntimes, a user device is infected with malware without the user\u2019s knowledge and\nbecomes enrolled in what we would typically describe as a botnet. More\nrecently, we have observed a large number of mobile devices used in proxy\nnetworks where the user has downloaded a mobile app developed using\ncompromised SDKs (software development kits). Effectively, the developers of\nthese apps have consented to or have been tricked into using an SDK that\nenrolls the device of any user running the app in a residential proxy network.\n\nThe net sum of this activity is that most of the traffic in these credential\nstuffing attacks appear to originate from the mobile devices and browsers of\neveryday users, rather than from the IP space of VPS providers. For more\ninformation on residential proxy services, we recommend this informative\nsummary by CERT Orange Cyberdefense and Sekoia.\n\n## Block it at the Edge\n\nOne of the key tenets of the Okta Secure Identity Commitment is to champion\ncustomer security best practices. We are committed to raising the bar for\ndefault security features in our platforms.\n\nIn February 2024, Okta released a well-timed capability into the Workforce\nIdentity Cloud (WIC) and Customer Identity Solution (CIS) that detects and\nblocks requests from anonymizing services.\n\nThis Early Access feature can be turned on at Settings > Features in the Okta\nAdmin Console.\n\nOrganizations that wish to deny access from specific anonymizers, and\nallowlist others, must be licensed to use Dynamic Zones (part of Adaptive\nMFA). Expect enhancements to this feature over the weeks ahead.\n\nCustomers using the Customer Identity Cloud (Auth0) should consider the Attack\nProtection Suite, and consider the other recommendations in the table below.\n\n## Modern Defenses, Built into the Identity Platform\n\nThe unprecedented scale of these attacks has provided clear insights into the\ncontrols most effective against credential stuffing.\n\nThreatInsight, Okta\u2019s built-in control against high volume attacks, blocks\nrequests from IPs involved in large scale credential based attacks prior to\nauthentication.\n\nThe small percentage of customers where these suspicious requests proceeded to\nauthentication shared similar configurations: The Org was nearly always\nrunning on the Okta Classic Engine, ThreatInsight was configured in Audit-only\nmode (not Log and Enforce mode), and Authentication policies permitted\nrequests from anonymizing proxies.\n\nCustomers using Okta Identity Engine that (a) enabled ThreatInsight in log and\nenforce mode and (b) deny access requests from anonymizing proxies were\nprotected from these opportunistic accounts. These basic features are\navailable in all Okta SKUs. Upgrading to Okta Identity Engine is free, often\nhighly automated, and provides access to a range of features including CAPTCHA\nchallenges for risky sign-ins and passwordless authentication using Okta\nFastPass.\n\n## Broader Recommendations\n\nWe recommend Okta customers practice defense in depth to mitigate the risk of\naccount takeovers from credential stuffing attacks.\n\nRecommendation| Workforce Identity Cloud (Okta)| Customer Identity Cloud\n(Auth0)  \n---|---|---  \n1.| Embrace Passwordless|\n\n  * Require Okta FastPass and FIDO2 WebAuthn\n\n|\n\n  * Support PassKeys as a preferred sign-in method\n\n  \n2.| Prevent users from making poor password choices|\n\n  * Require 12 chars and no parts of username in Password Policy. Block passwords found in common password list\n\n|\n\n  * Enable Breached Password Protection or Credential Guard to prevent use of passwords known to have been breached in 3P sites\n\n  \n3.| Enforce MFA on sign-in|\n\n  * Require MFA in Global Session Policies\n\n|\n\n  * Require MFA for Password Authentication flows\n\n  \n4.| Deny requests from locations where your organization does not operate|\n\n  * Use Network Zones to block requests prior to authentication\n\n|\n\n  * Deny access by location using a WAF or via the Country-based Access Control Action\n\n  \n5.| Deny authentication requests from IPs with poor reputation|\n\n  * Deny requests made via anonymizing services (Early Access) or via Dynamic Network Zones\n  * Configure ThreatInsight in log and enforce mode to deny attempts based on the volume and velocity of failed requests from an IP\n  * Require CAPTCHA challenges on high risk logins\n\n|\n\n  * Use Suspicious IP Throttling to slow down login attempts from suspicious IPs\n  * Use Bot Protection to present CAPTCHA challenges to requests from suspicious IPs\n  * Use 3P Auth0 Actions integrations to check if an IP is associated with an anonymizing proxies\n\n  \n6.| Monitor for and respond to anomalous sign-in behavior|\n\n  * Enforce per-user Account Lockout. Exempt requests from devices that have successfully authenticated\n  * Monitor for ThreatInsight events and rate limit violations\n\n|\n\n  * Use Brute-force Protection to block and lockout accounts subject to persistent failed authentication requests\n  * Monitor for sign-in events using invalid usernames/non-existent users and/or previously breached passwords\n\n  \n  \n## TTPs used in Recent Attacks\n\n#### Top 20 ASNs\n\nAutonomous System Number| Network Provider  \n---|---  \n53667| FranTech Solutions  \n62744| Quintex Alliance Consulting  \n60729| Stiftung Erneuerbare Freiheit  \n1101| SURF B.V.  \n210558| 1337 Services GmbH  \n197540| netcup GmbH  \n16276| OVH SAS  \n60404| Liteserver  \n210644| AEZA INTERNATIONAL LTD  \n399532| Universal Layer LLC  \n200651| FlokiNET ehf  \n44925| 1984 ehf  \n51396| Pfcloud UG  \n4224| The Calyx Institute  \n51852| Private Layer INC  \n56655| TerraHost AS  \n36352| HostPapa  \n208323| Foundation for Applied Privacy  \n63949| Akamai Connected Cloud  \n41281| KeFF Networks Ltd  \n  \n#### User Agent\n\n    \n    \n    Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0\n\n## Relevant System Log Queries: Workforce Identity Cloud\n\nEvent| System Log Query  \n---|---  \nThreatInsight has Detected Access Requests from IPs Associated with Suspicious\nBehavior| eventType eq \"security.threat.detected\"  \nSuspected Brute Force Attack (T1110.001)| eventType eq\n\"security.threat.detected\" AND outcome.reason eq \"Login failures\"  \nSuspected Credential Stuffing Attack (T1110.004)| eventType eq\n\"security.threat.detected\" AND outcome.reason co \"Login failures with high\nunknown users count\"  \nSuspected Password Spray Attack (T1110.003)| eventType eq\n\"security.threat.detected\" AND outcome.reason co \"Password Spray\"  \nTargeted Brute Force Attack against a Specific Org| eventType eq\n\"security.attack.start\"  \n  \n## Relevant System Log Queries: Customer Identity Cloud (Auth0)\n\nEvent| Log Query  \n---|---  \nFailed login request| f  \nFailed login: Invalid username/email address| fu  \nFailed login: Invalid password| fp  \nLogin attempt from a known leaked password| pwd_leak  \nSignup (registration) attempt from a leaked password| signup_pwd_leak  \nIP address blocked: excessive failed login or registration requests without a\nsuccessful login| limit_mu  \nUser account lockout: excessive failed login requests per time period from the\nsame IP address| limit_sul  \nIP address blocked: excessive failed login attempts to a single user account|\nlimit_wc  \n  \nMoussa Diallo\n\nSr Manager, Identity Threat Research\n\nBrett Winterford\n\nRegional CSO, Okta APJ\n\nBrett Winterford is the regional Chief Security Officer for Okta in the Asia\nPacific and Japan. He advises business and technology leaders on evolving\nthreats and helps them harness advances in identity technology to drive\nbusiness outcomes and mitigate risk. Prior to Okta, Brett held a senior\nsecurity leadership role at Symantec, and helmed security research, awareness\nand education at Commonwealth Bank. Brett is also an award-winning journalist,\nhaving long ago been the editor-in-chief of iTnews Australia and a contributor\nto ZDNet, the Australian Financial Review and the Sydney Morning Herald. Most\nrecently, he was the founding editor of the Srsly Risky Biz newsletter, a\ncompanion to the Risky Business podcast, providing the cybersecurity, policy,\ndefense and intelligence communities with a weekly brief of the news that\nshapes cyber policy.\n\n  * Subscribe to RSS\n  * trust.okta.com\n  * sec.okta.com\n  * okta.com\n\n", "frontpage": false}
