{"aid": "40140584", "title": "Color and TTYs", "url": "https://eklitzke.org/ansi-color-codes", "domain": "eklitzke.org", "votes": 1, "user": "todsacerdoti", "posted_at": "2024-04-24 04:28:26", "comments": 0, "source_title": "Color and TTYs", "source_text": "Color and TTYs\n\n# Color and TTYs\n\nNovember 30, 2015\n\nMost people are used to being able to send certain color/formatting codes to a\nterminal. For instance, most terminal emulators support the ANSI color escape\ncodes. In fact, xterm goes beyond this and has supported 256 color output for\nabout ten years now and most other terminal emulators also support this\nextension.\n\nThe reality is that assuming that a terminal supports ANSI color codes is a\nbad idea for a bunch of reasons.\n\nThe most important reason is that the file descriptor you're printing to might\nnot be a TTY. This commonly happens when stdout is redirected to another\nprogram or a file. If you emit ANSI escape codes then the output is no longer\n\"plain text\" and it makes a bunch of common operations more difficult. It can\nbreak programs like grep if the search term spans escape codes. It also causes\nweird things to happen when you use programs like less (which will escape the\nescape codes by default).\n\nEven if the file descriptor you're printing to is a TTY, not all TTYs support\nANSI escape codes. For instance, you could be sitting at an actual 1960s\nteletype machine that doesn't support color output. Or you could be on an\nancient terminal that does support color output, but doesn't use the ANSI\nescape codes.\n\nIf you do want to print color at a minimum you should use isatty(3) to check\nif the file descriptor (typically stdout or stderr) is a TTY. Most other\nlanguages have native bindings to this; for instance, in Python you can use\nos.isatty and in bash you can use test -t. If you do this you're not actually\nguaranteed that the terminal supports ANSI escape codes, but most modern\nterminals (or more likely, terminal emulators) do support them so it's a\nfairly safe assumption. If you want to be really pedantic you should actually\nmake a best effort to check the output capabilities of the TTY device; you can\ndo this with termcap/terminfo, which typically would be done for you by a\nhigher level library like ncurses.\n\ntl;dr If you're going to send ANSI color escape codes to stdout, at the very\nminimum please check that this is reasonable with isatty first.\n\n  * Home\n  * Email\n  * PGP\n  * GitHub\n\n", "frontpage": false}
