{"aid": "40292853", "title": "RTK Experiments", "url": "https://n1vux.github.io/articles/Geodetic/RTK-experiments.html", "domain": "n1vux.github.io", "votes": 1, "user": "luu", "posted_at": "2024-05-07 23:49:50", "comments": 0, "source_title": "RTK-experiments", "source_text": "RTK-experiments\n\n# RTK Experiments\n\nCopyright \u00a9 2022, William D. Ricker, and licensed CC-BY-SA 4.0 or later .\n\n## Agenda/TOC\n\n  * Intro\n\n    * Why is RTK\n    * What is RTK\n  * Open-ness\n\n    * Open Hardware (and not)\n    * Open Firmware (and not)\n    * FLOSS and Gratis Apps\n  * Product\n  * Experiments\n\n    * kit\n    * test run\n    * first data collection expedition\n  * Appendix\n\n    * Caveats\n    * Glossary\n    * Credits & \u00a9\n\n## Intro\n\n  * Why is RTK\n\nWe get a false sense of accuracy from phone, car, hiking GPS.\n\n\u201cStay on road\u201d and perhaps inertial corrections let the GPS display cover for\nthe erratic measurements.\n\nIf we mark a point with a GPS and then ask for directions to get back there,\nit likely takes us to the right place close enough, as buildings/driveways are\nalmost far enough apart to be mostly non-overlapping in error. Most people\ndon\u2019t need 1m, 0.1m, or 1cm accuracy.\n\nIf you download the \u201ctracks\u201d off a GPS that was left on in a parked car,\nyou\u2019ll see a random \u201cstar\u201d as the position computed varies this way and that.\nA disturbingly large star, that shows that only with a very long term average\ncould you compute a 1m position. My Garmin GPS peering through a windshield-\nshaped hole with trees and house partially blocking what little sky it could\nsee drew a 50\u00d715m (150\u00d750\u2019) error star for us. If the nearest house-lots\nweren\u2019t vacant, many of the points in the star if chosen at random (whenever\none hits the \u201csave\u201d button) the position wouldn\u2019t obviously be associated with\nmy house! But the centroid of the star-cloud is roughly correct (slightly\noffset away from the house by i presume reflections).\n\nDriveway Error Star\n\nNative GPS precision/resolution in Civilian mode is 30m; a 5 minute average\ncan improve that to 5m, 12 hours average to maybe 1m? Dual Frequency L1+L2 and\nDGPS correction signals can improve that slightly, since the ionosphere bends\nL1 and L2 bands differently, but not by much. Military grade only improves on\ncodeless L1+L2 20%. (They didn\u2019t want us that close but algorithms are\nwinning.)\n\nIf one wants to map things smaller than a house accurately, or things hard to\nsee from medium distance away (10-50m) even dual L1+L2 & classical DGPS/WAAS\nisn\u2019t good enough.\n\nWhich is why surveyors use GPS equipment that is capable of correcting for all\nthe errors by using a continuous error stream from a near-by (practically)\nidentical receiver at a known location. (Known to \u00b11cm preferably.)\n\nProfessional GPS\n\nThese devices cost less than new cars, but I\u2019ve seen used cars for less\nlately. With a long-term occupation, it can get a \u00b11cm accurate position on\nthe tripod, and then can share that accuracy with the portable GPS on a\nsurveyor\u2019s rod.\n\n  * What is RTK?\n\nRTK is the latest walkabout form of enhanced GPS/GNSS position solution.\n\nIt\u2019s called Real Time Kinematic because it corrects in real time, when\nmoving.\u2020\n\n(from wikimedia \u00a9 2022 TS Eriksson - Own work CC BY-SA 4.0 )\n\nIn the simplest form, a base station on a precisely known location records\nphase data on received GPS/GNSS sat signals, both L1 and L2 bands, and notes\nthe corrections - and sends them to one or more rovers subscribers - most\nsimply via direct data radio if nearby, as illustrated. One can insert the\nInternet (via cellular data in field) and consolidating servers for (a) added\ncomplexity (b) only buying one unit.\n\nSubscription may be commercial, open/free, private, or public by e.g. MassDOT,\nMaineDOT (free, registration required). One can connect to the nearest station\nof the network by name (having looked up which is nearest) or a network may\nprovide a Virtual base by weighted-averaging several nearest bases to derive a\nvirtual correction for your location instead of just giving the nearest. (This\nrequires disclosing your location to the Network.)\n\n\u2020( Why bother calling it RTK? Because there is an alternative phase-difference\nenhancement scheme, requiring same high-end GNSS receiver hardware, that is\nnon-real-time, non-kinematic, that compares logged received phases - logging\nfor 12+ satellites in both L1 and L2 bands - at both a known base-station and\nan unknown station, logged over many hours, unmoving, with the log comparison\nand calculation done later to get just one (nearly) perfect location solution\nfor the unknown base. Can be < \u00b11cm if close enough to the known base which\nwas already known that well. This is great for professional surveyors setting\nup a chain of known positions extending from the nearest public base for their\nfuture use in their remote territory, moving their own base unit around.\nThere\u2019s also a compromise that doesn\u2019t use Internet or data radios, so is not\nreal-time but is still kinematic: One can also log raw data while moving\naround and capturing approximate GPS points, and compare raw field logs to\nbase logs later, back in the office, to get corrected positions for the points\ncollected in the field. )\n\n## Open-ness\n\n  * Hardware solution that is partly Open Hardware\n\n    * Open Hardware\n\n      * git for board;\n      * graphics, case\n      * ESP32 (wiki) is not open hardware but proprietary; however the firmware open \u00abESP32 is a feature-rich MCU with integrated Wi-Fi and Bluetooth connectivity for a wide-range of applications\u00bb, perfect for IoT and connectivity of larger devices; programmable like an Arduino but also by other embedded-development-tool-chains.\n      * u-Blox ZED-F9P, is also not open hardware but proprietary; it\u2019s a Multi-band GNSS receiver, rather specialized.\n    * Open Firmware\n\n      * for the ESP32 and device UI git\n      * but not for F9P, which requires a proprietary firmware blob that implements core GPS\n    * Free &/or Open Software\n\n      * recommended starter Collector App is Free as in Beer but not Open. SW Maps (manual), built for local OpenStreetMap mappers in Nepal. (YouTube tutorials; same fellow has a couple of QGIS tutorials also!)\n      * two FLOSS Collector App alternatives need patches in App and/or RTK-Express-Plus firmware to work via WiFi+BT; one or both might work on some tablets via USB to RTK (I haven\u2019t tested that yet):\n\n        * Vespucci OSM editor for Android (competitor to OSMAND?), knows about external GPSs), assumes you want to upload points and lines to OSM; tutorials don\u2019t document how can it act as a collector for non-OSM projects.\n        * QField FLOSS GIS field collector app specifically optimized for QGIS projects, but can export KML as well as GPKG and GeoJSON, so not tied to QGIS.\n        * All three are usable with Android tablet/phone\u2019s native GPS, and should eventually also be able to work with enhanced precision with RTK via BT/WiFi/USB. Alas only the non-FLOSS freeware works out of the box reliably today.\n        * UPDATES\n        * Mergin supports both iPhone and Android, is designed to work with external GPS or internal, but apparently requires a freemium Cloud (free for teachers & students but not us?) or put up your own server to connect QGIS plugin and Mergin on tablet? This is good if you have multiple field contrigutors to a single project but overkill for a lone mapper. Will it really not do \u201cpretend my tablet is a thumbdrive\u201d with USB? Also don\u2019t know if it will talk USB to GPS or not, and if it\u2019s compatible with the WiFi/BT choices on the SparkFun RTK. At least the server for build-your-own mini-cloud is FLOSS.\n    * other Open Hardware-ish projects using GPS and Rubidium for Precise Time, part of the Open Compute Time Appliances project\n\n      * TimeBeat Time4Pi GNSS Raspberry Pi CM4 module (not yet for sale; currently uses proprietary u-Blox chip and u-Blox firmware, working towards Open Firmware. Only compatible with CM4 since needs higher-end proprietary Broadcom NIC with Precise Time Protocol (PTP) onboard)\n      * TimeBeat Time Card\n      * video on both\n  * Product\n\n    * Warning - If you\u2019re used to GPS being inclusive complimentary in your phone, standalone GPS prices will be as staggering as real camera prices - like high end phone without carrier subsidy. These are still nickel-to-dime-on-the-dollar compared to Professional Surveyor packaged equipment that likely uses the same receiver chip.\n\n    * RTK Express Plus Kit - everything but the pole, tablet, and clamps.\n\n    * now available caseless ui-less with budget antenna too ( blog product)\n\n    * SparkFun RTK Express Hookup Guide includes nice tour of the case and board (guide for both Plus and original)\n\n  * Experiments\n\n    * kit: added recommended phone clamp, a tablet clamp and a carbon-fibre photo monopod i had on-land, and the Cellular/Wi-Fi AccessPoint i normally use, and voila\n\n    * test run: hike around a park in Boston, using MAINE live correction data (sub-optimal but it worked). Note how closely to the path/sidewalk the track stays; marked points at pitchers mound, porta-potty, stairs, flag-pole, fountain, are all \u00b11m.\n\n    * first real data collection: family cemetery in Maine, using Maine correction data (as should there) My first expedition is just within 25km radius of the nearest Maine CORS base-station; a professional survey outside of radius would need to provide their own base on a <\u00b11cm mark to achieve cm accuracy.\n\nI geo-referenced the WPA map of the cemetery in GEarth(Pro). (I need to learn\nto do that in QGIS.) And then set markers for known ancestors (and a few\nselect Uncles+Aunts) using Plot Numbers from FindAGrave.com. Note This WPA map\nis North right, viewed from road, downhill, as will be a couple screenshots,\nbut then we will switch North up. I loaded the resulting KML file (including\nsketched traces of the driveways) into SW Maps as a reference layer, and\ncreated empty \u201cstones\u201d \u201cphotos\u201d layers. I added a \u201cplots\u201d layer in the field\nwhen i used the GPS to draw a polygon around corners of most recent family\nplot. The red Google-Maps-ish markers are the KML look near here markers (and\nhave text of who if clicked). The sunset icons show where a photo was\ngathered. Track isn\u2019t currently showing on this view. My camera\u2019s GPS was\nlogging as i walked also. Let\u2019s compare the precision. Red Points on a dusty-\nrusty line are the normal GPS track points, connect the dots. Bright blue line\nis the RTK ground track. On a few loops, the regular GPS Track tracks the RTK\ntrack reasonably well if crudely, but others are just whacky - at no point did\ni jump the fence or even cross the drive north! Here the red-dots are from the\nPhoto layer. At each headstone, i took a PHOTO using not my camera but using\nthe SW Maps program on the tablet, which not only geotagged the photo at high\nprecision, it included it in the Photos layer of the GIS project. Here we\u2019ve\nimported the Photos layer together with the planning layer. Some of the stones\nare rather far from their plan point, but those could be funny-shaped larger\nplots. (Or bad metadata in grave index.) Note how far the highlighted red dot\n(Nathaniel Plummer in right hand detail panel) is from his plot marker. This\nis one of the 3 pictures taken for Nathaniel Plummer and wife.\n\n  * Caveats\n\n    * Coordinate Reference System: With an RTK system, you get coordinates in the US national reference system, which is slightly different from the normal GPS and GMaps \u201cWGS84\u201d reference system. To get sub-meter accuracy you have to understand and account for this, but the details would be an entire other talk and are thus omitted.\n  * Glossary\n\n    * Networked Transport of RTCM via Internet Protocol (NTRIP)\n    * differential GPS (DGPS) can conceptually cover a range of correction enhancement techniques. Specifically referred to original LF harbor broadcasts to locally correct Selective Availability time offset for mariners (and VHF for air). Largely supplanted by WAAS (& end of SA). RTK is conceptually in the same family but more-so, transmitting corrections for subtler forms of error.\n    * real-time kinematic positioning (RTK)\n    * GPS: USA brand of GNSS; other sats are usable simultaneously.\n    * Wide Area Augmentation System (WAAS), US GPS brand of (GNSS augmentation](https://en.wikipedia.org/wiki/GNSS_augmentation)\n    * GNSS enhancement latest generation of max precision. Codeless L1/L2, carrier-phase tracking, and RTK\n    * Radio Technical Commission for Maritime Services (RTCM) standardized RTCM Messages for RTK corrections.\n    * National Marine Electronics Association (NMEA) standardized format for raw GPS output, NMEA sentence format.\n    * spatial reference system (SRS) or coordinate reference system (CRS)\n    * Continuously Operating Reference Station (CORS) \u201ca network of real-time kinematic (RTK) base stations that broadcast corrections to augment the local accuracy of GNSS (e.g. GPS) readings\u201d\n\n# Credits and \u00a9\n\n  * Composite work \u00a9 2022 William D Ricker . Licensed CC-BY-SA 4.0 or later\n  * WPA Map is Public Domain, thanks to DigitalMaine for scanning and sharing.\n  * MaineDOT CORS corrections feed for RTK\n  * Thanks to Greg T N1DAM for pungent commentary.\n  * OpenStreetMap maps are \u201c\u00a9 OpenStreetMap contributors\u201d used under their guidelines; the data is available under the Open Database License.\n  * Two original photos copyright \u00a9 2022 William D Ricker.\n  * All modifications to images \u00a9 2022 William D Ricker, using Fotoxx. Thanks Mike!\n  * GoogleMaps and web-scraped images used as Fair Use for educational purposes.\n\n", "frontpage": false}
