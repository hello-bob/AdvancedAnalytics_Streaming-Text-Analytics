{"aid": "40109237", "title": "A Delivery Chain Breach: A UK bank opened the back door to China", "url": "https://markalanrichards.com/posts/2024-04-21-chinese-backdoor-to-uk-bank/", "domain": "markalanrichards.com", "votes": 8, "user": "markarichards", "posted_at": "2024-04-21 21:04:38", "comments": 0, "source_title": "A Delivery Chain Breach: A UK bank opened the back door to China", "source_text": "A Delivery Chain Breach: A UK bank opened the back door to China\n\n# Mark Alan Richards\n\n  * Home\n  * Archive\n  * About Me\n\n# A Delivery Chain Breach: A UK bank opened the back door to China\n\n21 Apr 2024 security privacy data-protection\n\n## Timeline #\n\n  1. 2018: Financial Conduct Authority and Information Commissioner's Office notified of an ongoing remote access breach in RBS. RBS acknowledge their online banking pages can be altered for malicious purposes or in negligent ways by third parties. Regulators do nothing.\n  2. 18th September 2023: The security breach is reported to Metro Bank that various (unlikely Chinese) third parties have remote access to online banking accounts\n  3. 1st December 2023: Complaint escalated to the ICO\n  4. 9th February 2024: Metro bank respond (by post) that the risk is acceptable\n  5. 24th February 2024: Funnull acquire one of the back doors to Metro Bank, hosting their remote code in Baishan Cloud CDN\n  6. 29th February 2024: Cloudflare warns of acquisition\n  7. 25th Match 2024: Complaint raised to the Financial Conduct Authority, Bank of England and Financial Ombudsman Service\n  8. Between 11th and 17th April 2024: Metro bank remove remote access to Funnull, remote access by further third parties persists.\n\n## The security breach #\n\nAs customers logged in to online banking, Metro Bank's web pages downloaded\nand ran software direct from Chinese systems on customer devices.\n\nSoftware that could access anything in the banking website that the customer\ncould.\n\nThe bank requested this software from another website to improve their site;\nbut put no security protections in place to stop the software acting as the\ncustomer.\n\nThe website changed hands and moved to China: at this point the servers in\nChina could be used to control Metro Bank online banking sessions of any\ncustomer online.\n\nIf you are a Metro Bank customer then you should be asking how much data\nFunnull, Baishan or others captured from your bank account, who has your login\nbank details and checking whether payments have been correctly made. You may\nwant to reset your banking credentials.\n\nThere may be no reason to believe Funnull or Baishan acted in any malicious\nways.\n\nThe problem is the bank gave them the capability to and there is no audit\ntrail in UK systems to verify what their software did or what data they\ncaptured.\n\n## Not a supply chain attack #\n\n### Firstly what is a supply chain #\n\nThere are many famed software supply chain attacks, search Stuxnet or\nSolarwinds.\n\nA supply chain suggests a production line approach to software:\n\n  1. Source commonly used components (encryption, document templating, web servers, etc)\n  2. Use these to code and QA an app\n  3. Release it\n\nNo production line is perfect, but development and quality assurance processes\noffer an opportunity to spot compromised components before it is too late.\n\n### So what is a delivery chain #\n\nImagine that instead of a company supplying a product to you directly to your\nhands, they send it to delivered to your address.\n\nSearch about problems brands have faced selling on Amazon with scams and\ncounterfeit products. It offers a flavour of the nature of risks companies\nface when another delivers their product.\n\nThis is the domain of this attack.\n\nAt least in a supply chain attack, if a compromised component goes through the\nproduction process there might be a record, a chain of custody to work out\nwhere it came from and how much risk there is.\n\nBecause this was delivery side, the only parties who have any idea of what was\nactually delivered are the couriers (Baishan) and the developers (Funnull).\nMetro Bank just put an order in for the software to be delivered into their\nweb page and blindly ran it.\n\nAlthough we hope every delivery was the same (therefore Metro Bank would\nlikely have seen the code to verify) the web is designed for each file to be\nsent uniquely and to make matters worse, the purpose of Funnull's service was\nto offer different JavaScript for different users (depending on their browser\ncapabilities) and it seems unlikely it would have taken much effort to create\na version of this to target banking customers.\n\nI'm not sure it is possible for a UK entity to verify whether a targetted\nattack happened; we must just hope it hasn't.\n\nDuring the period, had Funnull just provided a compromised asset to all,\nperhaps that stole login details or attempted random payments, I cannot\nimagine a front page news story \"Metro Bank hacked, customers' online banking\nin disarray\" would have been good for Metro Bank's share price or be a good\nheadline if they wish to avoid a bank run.\n\n## The even weirder part #\n\nBefore Metro Bank gave access to China, the previous owner of the website ran\nthe website as a personal project.\n\nThus, Metro Bank gave remote access to all their customers accounts to one guy\non the internet.\n\nThat was what Metro Bank signed off as being an acceptable risk.\n\n## Regulators asleep at the wheel #\n\nLaws overseeing both financial systems and personal data protection demand\ncompanies to have appropriate security controls.\n\nRegulators of these laws have in both instances ignored prior warnings of the\nrisks in this domain.\n\nGiven the Post Office Scandal, we can only hope they awake to the extremely\nvulnerable position users are in when others can remotely access systems as\nthem.\n\n  * Previous: Who doesn't have remote access to your bank account?\n\n", "frontpage": true}
