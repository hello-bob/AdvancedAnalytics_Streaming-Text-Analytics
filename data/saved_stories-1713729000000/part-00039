{"aid": "40104410", "title": "Doom-htop: The classic DOOM game over htop", "url": "https://github.com/0x0mer/doom-htop", "domain": "github.com/0x0mer", "votes": 10, "user": "thunderbong", "posted_at": "2024-04-21 09:53:48", "comments": 0, "source_title": "GitHub - 0x0mer/doom-htop: The classic DOOM game over htop, the text-based process viewer", "source_text": "GitHub - 0x0mer/doom-htop: The classic DOOM game over htop, the text-based\nprocess viewer\n\nSkip to content\n\nSign in\n\n# Search code, repositories, users, issues, pull requests...\n\nSearch syntax tips\n\nSign in\n\nSign up\n\nYou signed in with another tab or window. Reload to refresh your session. You\nsigned out in another tab or window. Reload to refresh your session. You\nswitched accounts on another tab or window. Reload to refresh your session.\nDismiss alert\n\n0x0mer / doom-htop Public\n\nforked from ozkl/doomgeneric\n\n  * Notifications\n  * Fork 2\n  * Star 100\n\nThe classic DOOM game over htop, the text-based process viewer\n\n### License\n\nGPL-2.0 license\n\n100 stars 2.1k forks Branches Tags Activity\n\nStar\n\nNotifications\n\n# 0x0mer/doom-htop\n\nThis commit does not belong to any branch on this repository, and may belong\nto a fork outside of the repository.\n\n1 Branch\n\n0 Tags\n\nThis branch is 2 commits ahead of ozkl/doomgeneric:master.\n\n## Folders and files\n\nName| Name| Last commit message| Last commit date  \n---|---|---|---  \n  \n## Latest commit\n\n0x0merWorking. Moved files to forked repoApr 12, 2024efe8154 \u00b7 Apr 12, 2024Apr\n12, 2024\n\n## History\n\n80 Commits  \n  \n### doomgeneric\n\n|\n\n### doomgeneric\n\n| Working. Moved files to forked repo| Apr 12, 2024  \n  \n### screenshots\n\n|\n\n### screenshots\n\n| Working. Moved files to forked repo| Apr 12, 2024  \n  \n### .gitignore\n\n|\n\n### .gitignore\n\n| Working. Moved files to forked repo| Apr 12, 2024  \n  \n### LICENSE\n\n|\n\n### LICENSE\n\n| Create LICENSE| Aug 18, 2019  \n  \n### README.TXT\n\n|\n\n### README.TXT\n\n| Working. Moved files to forked repo| Apr 12, 2024  \n  \n### README.md\n\n|\n\n### README.md\n\n| Working. Moved files to forked repo| Apr 12, 2024  \n  \n### doomgeneric.sln\n\n|\n\n### doomgeneric.sln\n\n| Windows GDI port| Aug 4, 2019  \n  \n### freedoom-license.txt\n\n|\n\n### freedoom-license.txt\n\n| Working. Moved files to forked repo| Apr 12, 2024  \n  \n## Repository files navigation\n\n# doom-htop\n\nEver wondered whether htop could be used to render the graphics of cult video\ngames? I know I have. In order to quench our curiosity and for your viewing\npleasure, I created doom-htop.\n\n# Table of Contents\n\n  1. How to build\n  2. How to run\n  3. How it works\n  4. Platforms\n  5. Troubleshooting\n  6. Further work required\n  7. F.A.Q\n  8. License\n\n## How to build\n\n    \n    \n    cd doomgeneric make -j8\n\nNotice! In order to use this project, you need a WAD (game data) file. The one\nI included is freedoom1.wad (All credit goes to The Freedoom project!).\n\nOf course you're welcome to download the classic free shareware version\nDOOM1.wad from here. (I wasn't sure if I was legally allowed to upload it to\ngithub, and decided against it).\n\n## How to run\n\nIf I were you, I would probably save any important work I have open before\ndoing this. That being said, I tested this code on a 12-year old Lenovo\u00ae\nThinkPad T430s with 8GB RAM and an Intel Core i7-3520M @ 2.90GHz running\nUbuntu 22.04 and it ran just fine.\n\nAnyways, simply run:\n\n    \n    \n    sed -i 's/update_process_names=0/update_process_names=1/' ~/.config/htop/htoprc sudo ./doom-htop -iwad freedoom1.wad htop -d 1 -s M_VIRT\n\nIt doesn't matter whether you run doom-htop or htop first.\n\nThe sudo is only needed in order to open your keyboard's device.\n\nIf you're the kinda person who would rather not run sketchy programs off the\nInternetTM with root privilges, you can go ahead and run it without sudo and\njust look at the pretty pictures.\n\nThe -d 1 is because we're going for that sweet, sweet 10 FPS refresh rate, and\nthe -s M_VIRT is because we're gonna want to sort the processes by virtual\nmemory allocation, which should be pretty indicative of our processes and\nbunch them up together nicely. If for some reason that doesn't work for you,\nyou can go ahead and play with the define PROCS_MALLOC_SIZE in main.c until\neverything looks nice.\n\nFinally, the sed command is needed because by default, htop doesn't refresh\nthe processes' names every time. This design choice was probably made because\nhtop wasn't originally designed to render ascii-art videos, but we'll never\nknow for sure.\n\n## How it works\n\nIt's pretty straight-forward, actually. The amazing project\nhttps://github.com/ozkl/doomgeneric which I forked, did all the heavy lifting.\nI simply added the 3 files:\n\n  1. main.c\n  2. keylogger.c\n  3. ascii_stuff.c\n\nAnd edited a few others.\n\nI wrote a simple image-to-ascii converter that generated the long if statement\nyou can find in the file ascii_stuff.c.\n\nThe main doom process forks and creates as many process as there are lines in\nthe ascii converted image, and then creates a shared memory segment with every\nsingle one of them.\n\nThe main process copies each line in the image to the matching process's\nmemory segment, and each child-process copies from its segment and writes over\nits argv[0]. That's it, really.\n\nOriginally I wanted to do it with processes sorted by CPU usage, and create a\nprocess that consumes a specific CPU percentage, but that turned out to be\npretty hard. Then I though about using linux's nice, but as a user you're only\nallowed 19 possible values, and I wanted better graphics. Eventually I\nstumbled upon the idea of using virtual memory allocation, which as I said\nbefore, as pretty specific per process.\n\nI noticed that even when all the forked processes allocate exactly the same\namount of memory, htop shows the frame in the right order. I believe that\nhappens because maybe in case of equality the processes are then sorted by\ntime of creation? This works on my system (and is actually a little better,\nbecause that way there is less space in which another process could \"get into\nthe frame\"), but I wasn't sure how it would work on other people's systems and\ndidn't want to take the chance. This also means that I could have probably\njust given all the processes a unique nice value, but whatever.\n\nAnyways, then I created a simple keylogger that works by opening the\nkeyboard's device. This way the game is always playing in the background\nregardless of whether htop is open or not, which I think is neat.\n\n## Platforms\n\nI only ever tested it on my Ubuntu 22.04. I know the keyboard device is named\nsomething else in WSL and Arch, you're welcome to port it if you like.\n\n## Troubleshooting\n\n  1. Keyboard doesn't work\n\nThe device I'm trying to open is defined in #define KEYBOARD_DEVICE in the\nfile main.c. I'm sure it won't work universally. I only tested the code on\nUbuntu 22.04, and I know for a fact it won't work out of the box for WSL, and\nthat the device in Arch is named something else. You're welcome to port it to\nyour platform. Try to ll /dev/input/by-path, and choose one of the options\nthat has kbd in it.\n\n  2. The frame is frozen\n\nMaybe the sed command didn't work. You can change the htop configuation\nmanually by hitting the F2 key -> \"Display options\" -> mark [X] on \"Update\nprocess names on every refresh\"\n\n  3. sed: can't read /home/<user>/.config/htop/htoprc: No such file or directory\n\nI guess this will probably happen if you've never used htop before. In that\ncase run htop, quit, and run the sed command again.\n\n  4. For some reason the main doom process crashed, and you're left with a ton of zombie processes doing nothing: Run sudo pkill doom-htop.\n\n## Further work required\n\n  * htop moves the screen around when you're trying to walk around using the arrow keys which is pretty annoying. A simple but silly solution would be to change htop's focus after you start your game, for example by pressing a, which opens the menu for selecting your processors, then it won't be as annoying.\n\n## F.A.Q\n\n  1. Q: Why did you make this? A: I thought it would be funny.\n\n## License\n\nFreedoom is released under a BSD-like license which can be found in the file\nfreedoom-license.txt in the main directory. I believe all other code is GPL'd.\n\n## About\n\nThe classic DOOM game over htop, the text-based process viewer\n\n### Resources\n\nReadme\n\n### License\n\nGPL-2.0 license\n\nActivity\n\n### Stars\n\n100 stars\n\n### Watchers\n\n0 watching\n\n### Forks\n\n2 forks\n\nReport repository\n\n## Releases\n\nNo releases published\n\n## Packages 0\n\nNo packages published\n\n## Languages\n\n  * C 99.3%\n  * Other 0.7%\n\n## Footer\n\n\u00a9 2024 GitHub, Inc.\n\nYou can\u2019t perform that action at this time.\n\n", "frontpage": true}
