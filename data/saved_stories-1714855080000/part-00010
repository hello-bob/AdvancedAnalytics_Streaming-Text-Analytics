{"aid": "40257412", "title": "X.org on NetBSD \u2013 The State of Things", "url": "https://blog.netbsd.org/tnf/entry/x_org_on_netbsd_the", "domain": "netbsd.org", "votes": 1, "user": "HieronymusBosch", "posted_at": "2024-05-04 13:12:42", "comments": 0, "source_title": "NetBSD Blog", "source_text": "NetBSD Blog\n\n\u00bb The Guide | Manual pages | Mailing lists and Archives | CVS repository | Report or query a bug | Software Packages\n\nHome | RSS | Release engineering | Development | The NetBSD Foundation | Networking | General | Ports | Security | Events | Packages | Login\n\n### Bookmarks\n\n  * The NetBSD Project\n  * NetBSD Wiki\n\n### Feeds\n\n  * All\n  * /Release engineering\n  * /Development\n  * /The NetBSD Foundation\n  * /Networking\n  * /General\n  * /Ports\n  * /Security\n  * /Events\n  * /Packages\n  * Comments\n\n## X.Org on NetBSD - the state of things\n\nMay 04, 2024 posted by Nia Alarie\n\nA few years ago, I wrote a \"state of things\" blog post about Wayland on\nNetBSD. It's only natural that I should do one about X11, which is used by far\nmore people to get a graphical environment on NetBSD.\n\nThere are a lot of differences from how NetBSD and the typical distributor\nship X.Org. For one, we ship it as an optional monolithic package rather than\nseparate individual packages. This means every driver is included on every\nsystem, rather than as an optional module. Sometimes, this means we need to\nfine-tune driver selection to ensure the correct drivers are loaded on the\ncorrect hardware, since multiple conflicting drivers can claim a video output.\nWe also want sensible fallbacks, since if you're using a GPU from the future\nwith an old OS version, you probably want X to seamlessly fall back to a\nregular framebuffer.\n\nSecondly, the way our \"xsrc\" repository is set up, it's effectively\nfunctioning as a fork of X.Org that regularly pulls from upstream\nfreedesktop.org (but does not push back). This allows X development to happen\nas part of NetBSD.\n\nThirdly, we use our own build system based purely on BSD makefiles, not\nX.Org's based on GNU autotools. This fits well with our build.sh cross-\ncompilation system.\n\nWe have a number of drivers which have not made their way upstream. Perhaps\nthe most ubiquitous of these is xf86-input-ws, a driver which came from\nOpenBSD, targets an API fom NetBSD, and continues to be developed in both.\nThis is a generic input driver that can support any pointing device that the\nkernel supports. Unlike xf86-input-mouse, it doesn't assume the device is a\nmouse, and can support advanced touchpad and touchscreen features. Other\nNetBSD exclusives include xf86-video-pnozz, xf86-video-mgx, and xf86-video-\ncrime.\n\nThere are a number of drivers that are accelerated when used in NetBSD, but\nthe acceleration support is missing upstream. This is mostly due to the work\nof macallan@, who has diligently worked on drivers for accelerators found on\nSPARC and PowerPC hardware.\n\nX.Org has historically supported two 2D acceleration modes, XAA and EXA. XAA\nseems complicated - according to the X.Org Foundation it supports accelerating\n\"patterned fills and Bresenham lines\" (eh?). XAA was removed from the X.Org\nserver in 2012, and many old drivers were not updated to support the newer and\nsimpler EXA model, except in NetBSD, over a time period of several years.\n\nDid you know that Nvidia used to have an open source graphics driver? It\nsupported 2D acceleration for a range of cards. In NetBSD, it's retained for\nplatforms that included embedded Nvidia chips and aren't capable of (or\npredate, or don't want) the modern novueau driver. Six years ago, it was\nupdated in NetBSD to support EXA acceleration.\n\nThere are a few ways our X integration could be improved. While lots of\nattention has been paid to the server, less has been paid to clients\n(programs). Did you know that X includes a text editor, and that text editor\nsupports syntax highlighting and spell checking?\n\nNetBSD includes its own command-line spell checker and associated\ndictionaries, spell(1), inherited from the BSD UNIX of yore. It's pretty\nbasic, and only supports variations of English. To get spell checking to work\nin xedit, you need to install ispell (another command-line spell checker) from\npkgsrc, install a dictionary, then set some Xresources (or create symlinks) to\nmake sure xedit finds ispell. This could surely be streamlined by teaching\nxedit about spell.\n\nWe also ship every program that has been included with historical X.Org\ndistributions. This includes well-known things like xterm, slightly less well-\nknown things like xbiff(1), and obscurities like bitmap(1) (apparently a\n1-bit-per-pixel alternative to MS Paint). A while ago, we removed some\nlibraries which are no longer used by the modern X server, and maybe we should\nevaluate whether we need all of these programs too. xmh(1) is a frontend for a\nmail system that isn't included in base. Together, bitmap and xmh are around\n300 kilobytes.\n\nWe include fonts, bitmaps and scalable, for a wide range of computing devices.\nIn the latest versions of NetBSD, the font size will automatically scale with\nthe screen size to support HiDPI displays as well as small mobile devices.\nHowever, we don't ship a scalable cursor theme at the moment. We're also\nmissing high-resolution fonts for Japanese, a shame considering the popularity\nof NetBSD in Japan. Koruri looks interesting and is suitably small, maybe we\nshould import it.\n\nWhile we have many useful simple programs by default (a clock, a calculator,\nan editor, a window manager, a compositor, a terminal emulator...), we're\nnotably missing a screen locking program for X in the default install,\nalthough we have lock(1) for the tty.\n\nThe big question - does all this have a future? The good news is that all new\nhardware has generic support in X. Someone writes either a modesetting kernel\ndriver or a classical wsdisplay kernel driver and they will be automatically\nsupported by the associated drivers in X. The bad news is that to have\napplications running we require access to a larger open source ecosystem, and\nthat ecosystem has a lot of churn and is easily distracted by shiny new\nsquirrels. The process of upstreaming stuff to X.Org is an ongoing process,\nbut it's likely we'll run into things that will never be suitable for\nupstream.\n\nOf course, on NetBSD, you also have the option of trying vanilla modular X.Org\nfrom pkgsrc, or using something else entirely.\n\n[0 comments]\n\n\u00ab NetBSD 9.4 released | Main\n\nPost a Comment:\n\nContact | Disclaimer | Copyright \u00a9 1994-2015 The NetBSD Foundation, Inc. ALL RIGHTS RESERVED. NetBSD^\u00ae is a registered trademark of The NetBSD Foundation, Inc.\n\n", "frontpage": false}
