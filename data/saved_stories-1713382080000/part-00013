{"aid": "40063535", "title": "mSAIL: Milligram-Scale Sensor Platform for Monarch Butterfly Migration Tracking", "url": "https://cacm.acm.org/research/msail-milligram-scale-multi-modal-sensor-platform-for-monarch-butterfly-migration-tracking/", "domain": "acm.org", "votes": 2, "user": "sohkamyung", "posted_at": "2024-04-17 12:15:53", "comments": 0, "source_title": "mSAIL: Milligram-Scale Multi-Modal Sensor Platform for Monarch Butterfly Migration Tracking \u2013 Communications of the ACM", "source_text": "mSAIL: Milligram-Scale Multi-Modal Sensor Platform for Monarch Butterfly\nMigration Tracking \u2013 Communications of the ACM\n\nSkip to content\n\nSearch Sign In\n\nJoin ACM\n\nResearch and Advances\n\nData and Information\n\n# mSAIL: Milligram-Scale Multi-Modal Sensor Platform for Monarch Butterfly\nMigration Tracking\n\nThe ability to track navigation patterns of monarch butterflies is a critical\necosystem indicator.\n\nBy Inhee Lee, Roger Hsiao, Gordy Carichner, Chin-Wei Hsu, Mingyu Yang, Sara\nShoouri, Katherine Ernst, Tess Carichner, Yuyang Li, Jaechan Lim, Cole R.\nJulick, Eunseong Moon, Yi Sun, Jamie Phillips, Kristi L. Montooth, Delbert A.\nGreen II, Hun-Seok Kim, and David Blaauw\n\nPosted Apr 16 2024\n\n  * Share\n\n    * Twitter\n    * Reddit\n    * Hacker News\n  * Download PDF\n  * Print\n  * Join the Discussion\n  * View in the ACM Digital Library\n\n     * References\n\nRead the related Technical Perspective\n\n### Abstract\n\nEach fall, millions of monarch butterflies across the northern US and Canada\nmigrate up to 4000km to overwinter in specific mountain peaks in central\nMexico. To track monarchs precisely and study their navigation, a monarch\ntracker must obtain daily localization of the butterfly as it progresses on\nits 3-month journey. And, the tracker must perform this task while having a\nweight in the tens of milligrams (mg) and measuring a few millimeters (mm) in\nsize to avoid interfering with the monarch\u2019s flight. This paper proposes\nmSAIL, 8 \u00d7 8 \u00d7 2.6 mm and 62 mg embedded system for monarch migration\ntracking, constructed using 8 prior custom-designed ICs providing solar energy\nharvesting, an ultra-low power processor, light/temperature sensors, power\nmanagement, and a wireless transceiver, all integrated and 3D stacked on a\nmicro PCB with an 8 \u00d7 8 mm printed antenna. The proposed system is designed to\nrecord and compress light and temperature data during the migration path while\nharvesting solar energy for energy autonomy, and wirelessly transmit the data\nat the overwintering site in Mexico, from which the daily location of the\nbutterfly can be estimated using a deep learning-based localization algorithm.\nA 2-day trial experiment of mSAIL attached to a live butterfly in an outdoor\nbotanical garden demonstrates the feasibility of individual butterfly\nlocalization and tracking.\n\n## 1\\. Introduction\n\nAnimal migrators are critical ecosystem indicators because their long-distance\ntravels, often on continental scales, integrate information over broad and\ndiverse geographical locales and seasonal time scales. Tracking technologies\nhave allowed us unprecedented access to these paths, offering insights not\nonly into how migration works but also into how environments are changing and\nhow species interactions are impacted by changing movements and\ndistributions.^15 However, currently, only the larger animal migrators can be\ntracked for significant portions of their migratory flight (e.g., Thorup et\nal.^19). Long-term tracking devices require large amounts of energy and power\nfor information processing and storage, and large transceivers and antennas\nfor data transmission, all of which increase the size and weight of the\nsystem. This makes them unsuitable for insect migrators, which make up a large\npercentage of the total abundance of migrators (e.g., 2.1 billion birds\nbetween Europe and Africa versus 3.4 trillion insects over the southern United\nKingdom alone).^6 Insect migration detection has been limited to en masse\ndetection by vertical-looking entomological radar (e.g., Chapman et al.^3) or\ntracking for short periods of time or over short distances (e.g., Ware^22).\nThus, the ability to track small individual migrators over their entire\nmigratory path will offer a tremendous advance in our understanding of\nmigration biology, the impacts of changing climate on small migrators, and the\neffects of migrants on local and global ecosystems.\n\nOne of the most enthralling animal tracking stories has been that of the\niconic eastern North American Monarch butterfly (Danaus plexippus). Each fall,\nmillions of monarchs across the US and Canada migrate up to 4000 km to\noverwinter in the same cluster of mountaintops in central Mexico. In spring,\nthese migrants mate and remigrate northwards to repopulate their northern\nbreeding territory over 2\u20134 partially overlapping generations. Because each\nmigrant monarch completes only part of this round trip and does not return to\nthe overwintering site, this navigational task cannot be learned from the\nprior generation.\n\nThe number of monarchs completing the journey has steadily declined in the\npast decades, coincident with the decreased availability of their milkweed\nhost plant. The US, Mexico, and Canada have invested tremendous resources into\nmonarch conservation efforts, including enacting specific policy initiatives,\npublic outreach programs, and habitat protection and restoration projects. The\nUS invested over $11 million between 2015 and 2017 alone.^12 Developing a\ntracking technology for monarchs can be key in these efforts, for instance\nthrough a detailed understanding of habitat use during migratory flight and\ndependence on weather conditions. Furthermore, it can significantly benefit\nanimal research and agricultural and environmental science.\n\nA monarch tracker must assure daily localization of the butterfly as it\nprogresses on its journey while not interfering with its flight. As such, any\ndeployed sensor must perform this task while having a weight in the tens of\nmilligrams (mg) and measuring a few millimeters (mm) in size. The conventional\nmethod for determining location is to use GPS. However, the received signal\nfrom the satellites is very weak (\u2013155 dBm) and hence requires a power-hungry,\nvery low noise amplifier (e.g., 25 mW by Mediatek MT3339). To power such a\nsystem requires, at minimum, a coin cell-sized battery which by itself already\nweighs ~200 mg. Furthermore, the GPS carrier frequency of 1.58 GHz requires a\nrelatively large, centimeter (cm) scale antenna. As a result, the smallest\ncommercial GPS (PinPoint by Lotek Wireless) has a total weight of 1.1 g and a\nsize of 5 cm.^5 An alternative to GPS is the Motus system^17 which uses a\nradio beacon with tens of km transmit distance attached to each specimen\ncombined with geographically distributed receive towers. However, while\nreceive towers are relatively dense in Ontario and along the eastern seaboard,\nthere are very few along the primary monarch migration region in the Midwest.\nAlso, they require a long antenna (multiple cm) and have a weight >230 mg,\nwhich likely significantly impedes monarch flight.^8 Finally, daylight\ntrackers were proposed to compute location based on sunrise/set times (e.g.,\nIntigeo by Migrate Technology). However, their data readout requires physical\naccess to the sensor which is impractical in the case of the monarch\nmigration. Furthermore, their size/weight (320 mg and 12 \u00d7 5 \u00d7 4 mm) remain\nwell beyond that required for the monarch and, with only daylight-based\nsensing, location accuracy is limited, especially during the equinox.\n\nWe propose a new wireless sensing platform, mSAIL (Figure 1), specifically\ndesigned for the monarch migration study based on previously developed custom-\ndesigned ICs. mSAIL is an energy-harvesting, 62 mg device with an 8 \u00d7 8 \u00d7 2.6\nmm form factor (including antenna), that (1) simultaneously measures the light\nintensity and temperature using non-uniform temporal sampling; (2) compresses\nthe recorded data in 16 kB memory; and (3) wirelessly communicates data up to\n150 m distance using a crystal-less radio at the overwintering site in a\nrealistic non-line of sight (NLOS) scenario to custom-designed gateways. An\nintegrated, chip-size battery, continuously recharged using a custom-designed\nlight-harvesting IC with eight photovoltaic (PV) cells, provides energy\nautonomy.\n\nFigure 1: Proposed embedded system, mSAIL.\n\n## 2\\. Monarch Migration Tracking Application Scenario\n\nmSAIL records light intensity and temperature with accurate, 32 kHz crystal-\nbased timestamps along the monarch migration path. Standard light-based\nlocationing determines the sunrise and sunset time using a light intensity\nthreshold and then determines the geolocation using a Sun-Earth system model\nand Lambertian Law. The day length and center time depend on the geolocation\nand date and have been used in long-term larger animal tracking\nstudies.^13^,^16 However, it has the fundamental limitation of large latitude\nambiguity around the equinox (September 22 and March 20) when the day length\nis the same regardless of latitude. A second challenge is the significant\nlight intensity variation due to weather and terrain that an ideal sunlight\nintensity model is unable to capture.\n\nmSAIL adopts a novel data-driven algorithm for monarch migration tracking that\nleverages the principle of correlating multiple sensors. It achieves superior\naccuracy by applying deep neural network (DNN) models and multimodal fusion to\neffectively combine multiple sensor readings, including light intensity and\ntemperature. The objective of the DNN approach is to identify the cross-\ncorrelation between the multimodal readings and the sunlight intensity pattern\nas well as temperature information on a particular date. Different from Lam et\nal.^9 which utilize handcrafted models for light intensity and temperature,\nthe DNN approach learns an implicit, yet more complicated model from real\nsensor measurements, which makes it more robust to local variations.\n\nAlthough the details of the trajectory are not known, the final destination of\nthe monarch migration is known. Overwintering monarchs will distribute over a\nlimited number of sites within central Mexico with 21\u201378% of the total\npopulation reliably congregating at a single site (El Rosario sanctuary, at\nthe Monarch Butterfly Biosphere Reserve) each year.^21 mSAIL nodes will be\nprogrammed with a predefined rendezvous time to start wireless data offloading\nto multiple gateways deployed at that overwintering site. This scenario allows\nretrieval from both fallen (dead) and live monarchs as long as they are within\nthe communication range. Since an estimated ~90% of monarchs survive at the\noverwintering site,^2^,^18 the data recovery rate is expected to be\nsignificantly improved compared with current paper tagging methods^1^,^23 that\ncan only access fallen (dead) or fortuitously recovered butterflies. After a\ngateway retrieves the data log from an mSAIL, the entire butterfly trajectory\ncan be constructed using the DNN localization algorithm proposed by Yang et\nal.^24 The DNN is trained and evaluated by the data collected through a data\nmeasurement campaign with 306 volunteers from 2018 to 2020 across the US,\nCanada, and Mexico. They recorded light intensity and temperature using\ncommercial cm-scale sensors (Onset MX2202) as an emulation of mSAIL during the\nmonarch migration season. The localization algorithm^24 shows a geocoordinate\naccuracy of <0.6\u00b0 and <1.7\u00b0 in longitude and latitude respectively (1\u00b0 is\n~85.2 km in longitude and ~111.2 km in latitude in the midwestern US), which\nis sufficient for monarch studies.\n\n## 3\\. Small form Factor Integration\n\nThis section discusses how mSAIL achieves an mm- and mg-scale form factor\nusing 3D stacked custom ICs, batteries, and PCB antenna. mSAIL measures 8 \u00d7 8\n\u00d7 2.6 mm and 62 mg to not interfere with monarch flight, while still providing\nnecessary features as a complete system. It consists of three main parts:\nstacked IC layers, a PCB, and discrete components.\n\n### 3.1. Stacked custom IC layers\n\nmSAIL consists of a family of bare-die (without packaging) IC layers. Figure 2\nshows the layers: a PV cell IC, a ULP processor, and memory IC, ULP\ntemperature and light sensor ICs, a ULP RF transceiver IC, and a battery/power\nmanagement IC, which were all custom-designed, fabricated, and thinned. Three\ncustom-designed, thin-film batteries (CYM-BET) are also stacked as additional\nlayers. To minimize the total system volume, the layers are stacked on top of\neach other and connected by bonding wires. The layers communicate using a\ncustom low-power protocol called mBus.^14\n\nFigure 2: mSAIL structure and layer information.\n\n### 3.2. PCB and antenna design\n\nmSAIL places the IC stack on a PCB (Figure 3) with a dimension of 8 \u00d7 8 \u00d7 0.1\nmm, fabricated in a Rogers 4350B material. The weight of the PCB is reduced to\n19.5 mg with a large opening in the center of the single loop trace antenna,\nwhich takes 38% of the PCB area. In addition to the IC layers, the PCB\nintegrates two 4.7 \u03bcF and one 1.3 pF ceramic capacitors for the RF transceiver\nand a small 32 kHz crystal (1.3 \u00d7 1.1 mm, 2 mg), used by the processor layer\nfor system timekeeping.\n\nFigure 3: mSAIL PCB.\n\n### 3.3. System integration and encapsulation\n\nmSAIL integrates 12 layers, two 4.7 \u03bcF capacitors for RF communication energy\nbuffers, one 1.3 pF capacitor for RF frequency selection, and a 32 kHz crystal\non the PCB. They are electrically connected by PCB traces and bonding wires.\nThe ULP ICs are stacked without conventional chip packaging (i.e., bare-die)\nafter thinning, saving weight and size but rendering them extremely sensitive\nto light, and the bonding wires are very fragile. Thus, they must be properly\nencapsulated to provide physical protection and block light. At the same time,\nthe PV cell layer must be exposed to light to perform energy harvesting and\nlight level measurement. To address these simultaneous integration\nconstraints, the PV cell layer is placed on top of the other layers for access\nto light. The bottom layers are encapsulated with hard, black epoxy to provide\nphysical protection and block light from reaching the sensitive electronics.\nThe top PV cell layer is covered by a clear epoxy to expose the PV cells to\nlight. Below the PV cell layer, the spacer layer coated with aluminum blocks\nlights coming through the PV cell layer. A silicone mold ensures the epoxy\nonly surrounds the layers to not increase the total weight. Thus, its weight\ncontribution is reduced to 27.9 mg, which is a 5.9\u00d7 reduction compared to if\nthe epoxy had covered the entire PCB area. Finally, the entire mSAIL is coated\nby parylene, which is biocompatible, blocks moisture, and electrically\nisolates conductive points on the PCB from the environment.\n\nAfter encapsulation, mSAIL is programmed via optical communication using a\nportable LED shining on the exposed PV cells. The processor layer decodes on-\noff-key modulated (0.8 kbps) commands and programs the system accordingly.\n\n## 4\\. Energy Autonomous Operation\n\nmSAIL uses its PV cells to sustain the charge of its integrated batteries\nduring the 3-month migration which has sufficient energy to power the wireless\ndata transmission at the overwintering site. The system must minimize energy\nconsumption since the mm-scale batteries only store 18 \u03bcAhr of charge and the\nmm-scale PV cells only recharge the battery with 100 nW\u201320 \u03bcW from 400 lux to\n30k lux. The battery can only sustain 49 minutes if mSAIL continuously\noperates in active mode without careful energy management.\n\n### 4.1. Dynamic operation modes\n\nmSAIL optimizes energy consumption by employing three different operation\nmodes: active, sleep, and radio. In active mode, it measures temperature,\ntriggers light measurement, processes, stores, and time stamps measured data,\nand reconfigures the power management unit for optimal efficiency. The active\nmode consumes 22 \u03bcA on average running for a duration of 1.2 seconds. For\npower reduction, the sleep mode turns off all circuits except for essential\nblocks: the 32 kHz crystal oscillator, the volatile SRAM memory, the light\nsensor, and power management. Also, it reduces the DC-DC converter clock\nfrequency from 588 kHz to only 370 Hz to maintain a high power conversion\nefficiency of 66% at 56 nA sleep mode current (29\u00d7 efficiency reduction\ncompared to if kept constant). mSAIL is in sleep mode from 98.0% around\nsunrise/set to 99.8% at the center of day and night. Due to the large period\nratio of 150:1 between the sleep and active modes, the overall system energy\nconsumption is substantially determined by the sleep mode.\n\nAfter the monarch arrives at the overwintering site, mSAIL will wirelessly\ntransmit all the stored data to a gateway at the predefined rendezvous time,\nconsuming 130 \u03bcW on average. This consumes 211 mJ over 27 minutes, which must\nbe supported by the integrated battery with an energy capacity of 259 mJ.\nDuring the transmission, the processor monitors the batteries and if they\ncannot support the entire data transmission, mSAIL waits for the batteries to\nbe charged to 3.9 V (detected by an integrated ADC) and then transmits the\nremaining data at the next rendezvous time.\n\n### 4.2. Ambient light energy harvesting\n\nmSAIL generates high voltage by electrically connecting eight custom-designed\nPV cells in series and directly charging the batteries without any circuit\noperation or switching loss. The number of PV cells is set eight to place\ntheir effective maximum power point at a relatively low light level (500 lux\u20132\nklux) so that energy harvesting is supported at these low light levels.^10 At\nstronger light levels, the harvesting efficiency decreases, but the absolute\nharvestable energy is much greater. While mSAIL could benefit from a large\ncharging current at strong light, its energy harvesting efficiency is\noptimized at a low light level to maximize the acceptable light range for\nenergy harvesting. The battery voltage does not increase beyond 4.2 V because\nan over-charging protection circuit stops the energy harvesting, protecting\nthe ICs as well as the battery.^10 At very low light levels (<100 lux), the\nenergy harvester cannot provide enough voltage to charge the batteries and\nimposes a risk of discharging the battery instead. To prevent this problem, a\ndiode is inserted between the batteries and the output node of the PV cell\nlayer.^10 This results in a harvesting efficiency loss of 7% from the voltage\ndrop across the diode during energy harvesting, which is easily compensated by\nthe improved efficiency from not having an active up-converter.\n\n## 5\\. Data Management\n\nDue to the silicon area constraint, mSAIL has a limited data storage capacity\nof 16 kB in custom ULL SRAM for the 3-month journey. For the DNN sensor fusion\nlocalization algorithm,^24 measurement intervals of 1 and 32 minutes are\ndesired for light and temperature, respectively. Temperature changes are\ngradual so the required measurement interval is much longer than the light\nrecording interval since light levels can vary rapidly with weather or\nshading, and change exponentially around sunrise/set time. Since the\ntemperature and light sensor outputs are encoded with 24 and 48 bits per\nmeasurement, respectively, storing raw data would require 772 kB of SRAM to\nstore all the measurement data during the migration period, which is well\nbeyond the 16 kB storage capacity. Thus, mSAIL reduces the data storage\nrequirement by compressing the data using Huffman-coded, log-scale encoding\nwith a nonuniform sub-sampling scheme guided by dynamic sunrise/sunset time\ntracking. The proposed data compression also reduces energy consumption for\nwireless data transmission at the overwintering site.\n\n### 5.1. Dynamic sampling rate\n\nThe localization algorithm requires a light profile for the entire day.^24\nHowever, temporal resolution around sunrise and sunset, where intensity level\nchanges exponentially, is more critical. To reduce the power consumption and\nrequired memory space, mSAIL reduces the number of measurements by dynamically\ncontrolling the sampling rate. It measures the light every minute for 3 hours\naround sunrise and sunset and every 32 minutes otherwise, which reduces the\nstorage size by roughly 4\u00d7. Data during the night is assumed to be 0 lux and\nis not stored. In addition, after the 3-hour window of 1-minute interval\nmeasurements is obtained, mSAIL further sub-samples light measurements by\napplying gradually increasing sampling intervals. From the time when the light\nlevel crosses a threshold (e.g., 2 lux) and moves toward the center of the\nday, it stores 4 samples at 1-minute intervals, 8 samples at 2-minute\nintervals, 4 samples at 8-minute intervals, and the rest of the 3-hour window\nare stored at 32-minute intervals (Figure 4). This further reduces the storage\nrequirement by 10\u00d7, without noticeable localization accuracy degradation\n(Section 7).\n\nFigure 4: Sampled light with varying sampling rates.\n\n### 5.2. Sunrise and sunset tracking\n\nTo perform the proposed dynamic subsampling, mSAIL must track sunrise and\nsunset times which will change as the butterfly travels. Without dynamically\ntracking sunrise/ set, 14 hours per day of 1-minute measurements would be\nnecessary to cover all the possible sunrise/set times across different\nlocations during the migration. Such a large window of high-frequency\nmeasurement results in longer active times for processing data and higher\nenergy consumption.\n\nmSAIL predicts the sunrise and sunset times each day based on the previous\nday. We limit our discussion in this section to sunrise times for brevity, but\nthe method applies similarly to sunset. The model can be described by the\nequation T_n = T_n\u22121 + \u0394T_local + \u0394T_global where T_n is the time the light\nlevel crosses the threshold on day n. \u0394T_local describes the local changes in\nsunrise time and light levels had the butterfly not traveled; this contains\nthe changes from seasonal, weather, and shading variations. \u0394T_global\ndescribes the changes in sunrise time due to the global displacement of the\nbutterfly. \u0394T_local can be measured by the difference in the sunrise times\nbetween consecutive days at the same location in the reference volunteer\ndataset^24 shown in Figure 5. We can pick 30 minutes as a reasonable upper\nbound of \u0394T_local based on Figure 5, whereas \u0394T_global can be determined\nanalytically. The maximum reported speed of a monarch butterfly is 265 miles\nper day.^20 This is a conservative estimate\u2014a more typical value would be\n50\u2013100 miles per day. At 45 \u00b0N, 265 miles corresponds to about 5.5 degrees in\nlatitude which shifts the sunrise and sunset times by \u00b122 minutes in the worst\ncase assuming that the butterfly travels only in the east-west direction.\nTherefore, |\u0394T_local| \u2264 30, |\u0394T_global| \u2264 22, and T_n = T_n\u22121 \u00b1 52 holds. And\nif the 1-minute light measurement window is set to \u00b152 minutes before and\nafter the previous sunrise time, it is guaranteed to capture the next sunrise.\nThe recorded samples require an additional 54 minutes after sunrise and,\nhence, the total window is set to 1 hour before and 2 hours after the previous\nsunrise time.\n\nFigure 5: Histogram of the relative time difference between consecutive\nsunrises and sunsets.\n\n### 5.3. Data compression\n\nThe dynamic sampling rate reduces the number of data points down to ~100 light\nand 48 temperature samples per day. Each raw light and temperature measurement\nis 48 and 24b long, respectively. To compress both light and temperature data\nwith the limited instruction code space and computational complexity, a\ncompact lossy compression algorithm is applied to convert the integer data\ninto an approximated log2 representation with fixed-point precision without\nusing a large lookup table. Log2 representation is suitable for the light data\nas it changes exponentially around sunset/rise time. After compression, all\nthe data for 90 days occupies 15.7 kB of mSAIL memory.\n\nFinally, data is further compressed by storing only the difference from the\nprevious data. During sunrise and sunset, log-scale light intensity samples\nchange by a relatively small amount (typically 1 or 2 bits). A Huffman\ncoding^7 is applied to this difference to produce the minimum codeword length.\nThe combined encoding scheme further reduces a light measurement to 5.1b and a\ntemperature to 3.0b on average. A simulation on the volunteer-collected data\nshows that only 7.2 kB SRAM is required to store 3-month data including\noverhead, which is acceptable for the mSAIL.\n\n### 5.4. Data packets for RF communication\n\nDuring wireless data retrieval, each packet is separately transmitted and\ncontains 96b including 16b of CRC and a 12b packet header. The remaining 68b\nstore the data. To reduce overhead, four packets are grouped together (272b\ndata) as an independent decodable unit. Each unit storing light measurements\nincludes a 17b timestamp (with resolution down to 1 min) and an 11b initial\nmeasurement value (necessary for differential decoding). Units storing\ntemperature measurements include a 13b timestamp (with resolution down to 30\nmin) and a 7b initial measurement. The remaining light and temperature\nmeasurements are stored as an encoded difference from the previous measurement\nas described in Section 5.3. The remaining timestamps are omitted as they are\ncalculated at the gateway since the light and temperature intervals are\ndeterministic, though non-uniform. Once mSAIL reaches the overwintering\ndestination (inferred by the rendezvous time), mSAIL adds on the packet number\nand CRC to each unit to create four 96b packets for transmission. The CRC\nenables multi-bit detection of erroneous packets in the receiving gateway.\nAlthough a missing packet cannot be recovered, the earlier packets can still\nbe decoded using the timestamp and initial data stored in the first packet\neven if later packets are lost. Also, since mSAIL will periodically retransmit\nits data, lost packets can be recovered on subsequent data transmissions.\n\n## 6\\. Wireless RF Communication\n\nUsing a ULP RF transceiver without an RF-reference crystal (10 MHz range) and\nPLL^4 is necessary to enable mm-scale system integration and also ultra-low\npower consumption, but it unavoidably sacrifices the frequency stability of\nthe RF signal. To address this, the system employs a gateway-assisted\nsynchronization protocol that is initiated by mSAIL node transmission. In the\nproposed protocol, an mSAIL node asynchronously initiates a communication\nsession by transmitting a packet first. Around the rendezvous time, the\ngateway continuously listens to the channel to estimate and track the carrier\nfrequency and sampling frequency offsets (CFO and SFO) of the mSAIL node via a\ncomputationally efficient 2D-FFT-based correlation. Upon detecting a valid\npacket from an mSAIL node, the gateway can send a customized packet that pre-\ncompensates the CFO/SFO of the detected mSAIL node. This enables a PLL-less\nmSAIL node implementation which eliminates the need for power-demanding\nsynchronization & correlation processes at the mSAIL node. The gateway\nprotocol and real-time baseband signal processing are implemented on the FPGA\n(ADRV9361-Z7035) of a custom gateway (USRP X310 compatible, Figure 9). This\nasymmetric link between the gateway and mSAIL takes advantage of excellent\nreceiver sensitivity and abundant FPGA resources for digital signal processing\nin the gateway, allowing the mSAIL transceiver to be simple, low power, and\nmostly asleep.\n\nA major issue of using an mm-scale battery for mSAIL is its high internal\nresistance, which prevents drawing a large peak current (mA range) to transmit\nRF signals. Note that prior crystal-less transceiver designs such as\nMaksimovic et al.^11 do not have the same issue as they operate with a\nconventional battery without extreme size and weight constraints. We tackle\nthis current limitation issue of the mm-scale thin-film battery by powering\nthe transceiver with a trickle-charged energy buffer capacitor, as shown in\nFigure 6. The proposed system exploits this sparsity to realize an energy-\nefficient sparse pulse position modulation (PPM) scheme. Unlike conventional\nPPM, the symbol duration is dominated by the recharging time. mSAIL uses a\nbinary sparse-PPM with 2.25 mW active transmit power (at \u2248 15% circuit\nefficiency), 50 \u03bcs pulse duration, and 4.8 ms recharging time for 0.2 kbps\ndata rate at an average power consumption of 156 \u03bcW during the packet\ntransmission.\n\nFigure 6: Modulation and recharging scheme.\n\nThe main challenge in the gateway design is to identify the CFO and SFO with\nthe mSAIL node in real-time. On the mSAIL RF transceiver, the baseband\nsampling clock is generated by an RC relaxation oscillator^4 and its carrier\nfrequency is determined by the inductance value of the 2D magnetic dipole loop\nantenna and the matching on-/off-chip capacitors without a PLL. Thus, it is\ninevitable that an mSAIL node has significant SFO (up to 0.5%) and CFO (up to\n2%) variation due in part to variations in process, voltage, and temperature.\nCalculating accurate SFO/CFO and compensating these offsets in realtime is\nperformed with the signal processing data path shown in Figure 7 implemented\non the gateway\u2019s FPGA.\n\nFigure 7: DSP datapath implemented on the gateway.\n\nThe preamble from mSAIL always starts with an RF pulse train with a constant\npulse interval. Thus, we propose a novel 2D-FFT-based process that identifies\nthe SFO and CFO at the same time. The incoming signal is first divided into\nmultiple time domain signal frames, whose length is equivalent to half of the\npulse width. A 1D-FFT is performed on each signal frame and the signal power\nis computed for each frequency offset bin, which corresponds to a specific CFO\nhypothesis. A second FFT is then performed on the power of frequency domain\nsamples (output of the first FFT) that belong to that same bin (one specific\nCFO). This process is repeated for all frequency bins. Each bin of the second\nFFT output now corresponds to a specific SFO fundamental frequency. To\naccurately estimate the actual pulse repetition frequency of the preamble, we\nadd the power of all harmonic frequency bins corresponding to a specific\nfundamental frequency. Figure 8 shows an example of the 2D-FFT harmonic\nintegration output from the preamble processing, where the y-axis corresponds\nto the CFO bin and the x-axis is the SFO fundamental frequency hypothesis. By\nfinding the maximum power from the 2D-FFT result, the gateway identifies the\nSFO as well as the CFO at the same time. The CFO FFT resolution is matched to\nthe signal bandwidth and inversely proportional to the preamble pulse width,\nwhich is 4\u20131000 \u03bcs in our system. Figure 8 is the result for 6.5 MHz CFO and 5\nkHz SFO from the 915 MHz and 250 kHz ideal carrier and sampling frequencies\n(plotted with a coarser resolution to make the high power peak region\nvisible). After the 2D-FFT process for the preamble, the gateway keeps\ntracking SFO during payload to eliminate residual SFO and to mitigate time-\ndrifting offset. The SFO tracking resolution is 1/4 of the pulse width.\n\nFigure 8: 2-D FFT for CFO and SFO joint estimation.\n\n## 7\\. Evaluation\n\nVarious performance evaluations have been run on mSAIL systems as described in\nthis section, including: (a) wireless communication distance evaluation at the\noverwintering site showing over 150 m NLOS distance and (b) 2-day outdoor live\nmonarch demonstration including wireless data transmission, post-processing,\nand localization.\n\nWe performed flow-through CO_2 respirometry on monarchs carrying a prototype\nmSAIL (compared to controls without the logger) to estimate the effect of the\nsystem load on flight metabolism. The test results showed neither a\nsignificantly different mass relationship from the control nor a significant\nchange in flight metabolic rate. Because the data in this preliminary study\nwas limited, further studies on the impact of long-distance flight and\naerodynamics, as well as the robustness of the mSAIL over a 3-month period,\nare warranted and planned.\n\n### 7.1. Wireless communication evaluation\n\nThe mSAIL radio transmission distance was tested at two locations. First, in\nan unobstructed outdoor environment, mSAIL was placed on a pole such that it\nwas an average of 20 m higher than the gateway to emulate conditions at the\noverwintering site when a monarch will be in a tall conifer. The results of\nthe test are shown in Figure 9(a). A 75 cm Yagi antenna with 11 dBi gain was\nattached to the gateway. The transmission was line-of-sight up to 494 m. A\nsimilar test was performed in a heavily wooded area at the overwintering site\nin Mexico, shown in Figure 9(b) using a 135 cm Yagi with 15 dBi gain which\nshowed excellent results at 150 m with a low (<5%) packet loss. In both cases,\nthe mSAIL was powered by attaching larger batteries using 10 mm leads to allow\nfor longer operation duration under continuous radio transmission for ease of\ntesting. However, in separate testing, this was shown not to impact radio\ndistance noticeably.\n\nFigure 9: RF communication distance test. (a) Result from the open-area test;\n(b) test in a wooded area.\n\nOur approach leverages the fact that monarchs cluster at impressive densities\nat the Mexican overwintering sites. The median density estimate is 20 million\nbutterflies (range 6\u201360 million) per hectare (10,000 m^2).^18 Therefore, even\nwith hundreds of meters of communication range, we expect to cover millions of\nbutterflies.\n\n### 7.2. Live Monarch localization\n\nFull system operation of mSAIL was demonstrated attached to a live monarch\nbutterfly in a botanical garden, as shown in Figure 10. The butterfly is kept\nin an outdoor, 42 \u00d7 42 \u00d7 76 cm cage, positioned on a 2.5 m tall pergola such\nthat the cage is not shaded by nearby buildings, on November 6th and 7th,\n2020, which is during the monarch migration season. The monarch was able to\nfeed ad libitum on butterfly nectar. For reference measurements, cm-scale\nsensors were placed in the cage and outside on the pergola. A receiving\ngateway with a 7\u201d omnidirectional whip antenna was mounted 8 m away in a\nnearby enclosed structure to receive the transmitted data regardless of\nweather conditions.\n\nFigure 10: Testing setup for the outdoor botanical garden test. (a) Overview;\n(b) mSAIL on monarch; (c) gateway; (d) centimeter-scale commercial sensor.\n\nLight and temperature measurement results. Figure 11 shows temperature data\ntransmitted from mSAIL mounted on the monarch. Data is also shown for the cm-\nscale sensor mounted on the pergola, along with the difference between the two\nsensors\u2019 measures. Temperature data agrees very well between 6 PM and 6 AM\nwith differences of no more than 2\u00b0C. During primary daylight hours, both\nsensors can be exposed directly to sunlight which can cause large local\nheating compared to ambient shade temperatures. While the cm-scale sensor was\nmounted on the pergola, facing up, the mSAIL was attached to the monarch\nwhich, though caged, could change orientation with respect to the sun and also\nclose its wings at times, thereby covering the sensor. Therefore, differences\nin daytime temperatures are expected. For these reasons, and because\nbutterflies will travel during the day, only nighttime temperature readings\n(16 hours) are used in the DNN localization algorithm.\n\nFigure 11: 2-day temperature: mSAIL vs. ref. sensor.\n\nFigure 12 shows the 2-day light data from the same mSAIL system and the same\ncm-scale sensor. Note that mSAIL is programmed to gather light data only\nduring daytime and sunrise/sunset intervals. Also, the cm-scale sensor\u2019s\nminimum light reading is zero which cannot be plotted on the log scale. The\ndata shows good agreement during sunrise and sunset times. Some of the\ndifferences during the daytime are the results of the difference in\norientation between the fixed cm sensor and the mSAIL. The cm sensor always\npointed upward while mSAIL orientation depended on the position of the\nmonarch. However, the neural network localization algorithm mostly relies on\nmeasurements surrounding sunrise and sunset. In addition, in practice,\nmeasurements during the day are less relevant since the monarch could be\ntraveling and, hence, not at a fixed location. In addition, to confirm the\naccuracy of the light readings, mSAIL was calibrated and tested with\ncontrolled light before the live monarch experiment. The resulting fit had an\nR^2 value of 0.9982.\n\nFigure 12: 2-day light data: mSAIL vs. ref. sensor.\n\nLocalization from mSAIL collected data. The quality of our measurements was\nevaluated using the localization algorithm introduced by Yang et al.^24\nAlthough it is possible to apply different localization algorithms using\nmSAIL-collected data, we chose the same algorithm proposed by Yang et al.^24\nto evaluate its data quality compared to the output obtained from the\nreference commercial sensor (Figure 13).\n\nFigure 13: DNN localization algorithm using mSAIL light and temperature\nmeasurement data.\n\nFor the live monarch mSAIL evaluation conducted on Nov. 6th and 7th in 2020,\nthe light and temperature data were wirelessly retrieved from the mSAIL unit\nand the butterfly was localized using the above method. Note that mSAIL\ncollected data was first decompressed and resampled to reverse the adaptive\nsampling and data compression described in Section 5. We then applied linear\ninterpolation to resample decompressed mSAIL measurements so that they have\nthe same sampling rate as the reference cm-scale sensors used in DNN training.\nWe evaluate our 2-day measurements in a grid surrounding the ground-truth\nlocation with a range of [\u221215, 15] degrees in latitude and longitude and a\nresolution of 0.25 degrees. The likelihood (i.e., DNN outputs) for the grid\npoints are visualized as heatmaps shown in Figure 14 where the center of the\ngraph is the ground-truth location. It is observed that light intensity alone\ncan provide accurate longitude estimation and that temperature significantly\nrefines the latitude estimation. The maximum likelihood estimations marked in\nFigure 14 provide an absolute error of 0.07\u00b0/0.26\u00b0 in longitude and\n0.03\u00b0/0.40\u00b0 in latitude for the first/second day, which translates to a\nmaximum error of 21.4 km and 44.5 km in longitude and latitude and aligns with\nthe accuracy reported by Yang et al.^24 evaluated with the cm-scale sensors.\n\nFigure 14: Localization likelihood output for two different days (a) and (b).\nCenter of each heatmap is the ground truth. Maximum error after sensor fusion\nis 21.4 km and 44.5 km in longitude and latitude.\n\nTo validate that the proposed data compression and adaptive resampling\ntechnique does not degrade the localization accuracy, we applied the same\ncompression and sampling technique to the volunteer cm-scale sensor data and\ncompared the localization accuracy with the original uncompressed data. Figure\n15 confirms that the proposed compression and dynamic sampling algorithm\nsuccessfully captures the most relevant features, thus it exhibits negligible\nlocalization accuracy difference.\n\nFigure 15: MSE of latitude and longitude evaluated biweekly with mSAIL data\ncompression vs. original uncompressed cmscale sensor data in Yang et al.^24\n\nIt is worth noting that the butterfly was stationary for the 2-day outdoor\ntest and there can be differences between data collected from stationary vs.\nmigrating butterflies. Analyzing the differences needs further investigation\nand it is left as future work.\n\n## 8\\. Conclusion\n\nThis paper proposes mSAIL, 8 \u00d7 8 \u00d7 2.6 mm and 62 mg embedded system for\nmonarch butterfly migration tracking with previously developed, custom-\nfabricated solar energy harvester, an ultra-low power processor,\nlight/temperature sensors, and wireless transceiver ICs, all integrated within\na 3D stacked form-factor. The proposed system is designed to record and\ncompress light and temperature data during the entire 3-month migration path\nwhile harvesting solar energy, and wirelessly transmitting the data at the\noverwintering site in Mexico to reconstruct the complete migration trajectory\nusing a deep learning-based sensor fusion localization algorithm. An initial\n2-day trial experiment of mSAIL attached to a live butterfly demonstrates the\nfeasibility of individual monarch butterfly localization and tracking using an\nelectronic device for the first time.\n\n## Acknowledgments\n\nWe are grateful to the Monarch Butterfly Biosphere Reserve Director (Felipe\nMart\u00ednez Meza), staff, and community partners for granting access to the\noverwintering colony. We thank Dr. M. Isabel Ram\u00edrez and the students for\nassistance at the overwintering site. This work was funded in part by Monarch\nButterfly Fund Flight Challenge, National Geographic, Mcubed, NSF DBI IIBR\n(#2045017 & #2043017), and NSF UNVEIL IOS (#1736249). The authors thank all\nvolunteers for data collection from 2018 to 2021.\n\n## References\n\n    * 1\\. Brindza, L.J. et al. Comparative success of monarch butterfly migration to overwintering sites in Mexico from inland and coastal sites. J. Lepid. Soc. 62, 4 (2008), 189\u2013200.\n\n    * 2\\. Calvert, W.H. et al. Mortality of the monarch butterfly (Danaus plexippus l.): Avian predation at five overwintering sites in Mexico. Science. 204, 4395 (1979), 847\u2013851.\n\n    * 3\\. Chapman, J.W. et al. Flight orientation behaviors promote optimal migration trajectories in high-flying insects. Science. 327, 5966 (2010), 682\u2013685.\n\n    * 4\\. Chuo, L. et al. 7.4 a 915mhz asymmetric radio using q-enhanced amplifier for a fully integrated 3\u00d73\u00d73mm3 wireless sensor node with 20m non-line-of-sight communication. In Proceedings of the 2017 IEEE Intern. Solid-State Circuits Conf. 132\u2013133.\n\n    * 5\\. Hallworth, M., and Marra, P. Miniaturized GPS tags identify non-breeding territories of a small breeding migratory songbird. Sci. Rep. 5, 11069 (2015), 06.\n\n    * 6\\. Hu, G. et al. Mass seasonal bioflows of high-flying insect migrants. Science. 354, 6319 (2016) 1584\u20131587.\n\n    * 7\\. Huffman, D.A. A method for the construction of minimum-redundancy codes. Inst. Radio Eng. 40, 9 (1952), 1098\u20131101.\n\n    * 8\\. Knight, S.M. et al. Radio-tracking reveals how wind and temperature influence the pace of daytime insect migration. Biol. Lett. 15, 7 (2019), 20190327.\n\n    * 9\\. Lam, C. et al. Incorporating sea-surface temperature to the light-based geolocation model TrackIt. Mar. Ecol. Prog. Ser. 419, 71\u201384 (2010), 11.\n\n    * 10\\. Lee, I. et al. A 179-lux energy-autonomous fully-encapsulated 17-mm3 sensor node with initial charge delay circuit for battery protection. In Proceedings of the 2018 IEEE Symp. on VLSI Circuits, 251\u2013252.\n\n    * 11\\. Maksimovic, F. et al. A crystal-free single-chip micro mote with integrated 802.15.4 compatible transceiver, sub-mw ble compatible beacon transmitter, and cortex m0. In Proceedings of the 2019 Symp. on VLSI Circuits, C88\u2013C89.\n\n    * 12\\. NFSF. Monarch butterfly conservation fund. https://www.nfwf.org/sites/default/files/monarch/Documents/three-year-report.pdf.\n\n    * 13\\. Nielsen, A. et al. Improving light-based geolocation by including sea surface temperature. Fish. Oceanogr. 15, 4 (2006), 314\u2013325.\n\n    * 14\\. Pannuto, P. et al. Mbus: An ultra-low power interconnect bus for next generation nanopower systems. In Proceedings of the 2015 ACM/IEEE 42nd Annual Intern. Symp. on Computer Architecture, 629\u2013641.\n\n    * 15\\. Pecl, G.T. et al. Biodiversity redistribution under climate change: Impacts on ecosystems and human well-being. Science. 355, 6332 (2017).\n\n    * 16\\. Rakhimberdiev, E. et al. A hidden Markov model for reconstructing animal paths from solar geolocation loggers using templates for light intensity. Mov. Ecol. 3, (2015), 10.\n\n    * 17\\. Taylor, P. et al. The Motus wildlife tracking system: a collaborative research network to enhance the understanding of wildlife movement. Avian Conserv. Ecol. 18, 8 (2017), 03.\n\n    * 18\\. Thogmartin, W. et al. Density estimates of monarch butterflies overwintering in central Mexico. PeerJ. 5, (2017), 04.\n\n    * 19\\. Thorup, K. et al. Resource tracking within and across continents in long-distance bird migrants. Sci. Adv. 3, 1 (2017).\n\n    * 20\\. U. F. Service. Migration and overwintering. https://www.fs.fed.us/wildflowers/pollinators/MonarchButterfly/migration/index.shtml#:: \u0303text=Monarchs%20can%20travel%20between%2050,265%20miles%20in%20one%20day.\n\n    * 21\\. Vidal, O., and Rend\u00f3n-Salinas, E. Dynamics and trends of overwintering colonies of the monarch butterfly in Mexico. Biol. Conserv. 180, (2014), 165\u2013175.\n\n    * 22\\. Ware, C. ISU student using radio telemetry to track monarch butterflies. https://www.amestrib.com/news/20180713/isustudent-using-radio-telemetry-to-track-monarchbutterflies.\n\n    * 23\\. Watch, M. Tagging monarchs. https://monarchwatch.org/tagging/.\n\n    * 24\\. Yang, M. et al. Migrating monarch butterfly localization using multi-modal sensor fusion neural networks. In Proceedings of the 28th European Signal Processing Conf., 2021, 1792\u20131796.\n\nInhee Lee, University of Pittsburgh, Pittsburgh, PA, USA.\n\nRoger Hsiao, University of Michigan, Ann Arbor, MI, USA.\n\nGordy Carichner, University of Michigan, Ann Arbor, MI, USA.\n\nChin-Wei Hsu, University of Michigan, Ann Arbor, MI, USA.\n\nMingyu Yang, University of Michigan, Ann Arbor, MI, USA.\n\nSara Shoouri, University of Michigan, Ann Arbor, MI, USA.\n\nKatherine Ernst, University of Michigan, Ann Arbor, MI, USA.\n\nTess Carichner, University of Michigan, Ann Arbor, MI, USA.\n\nYuyang Li, University of Pittsburgh, Pittsburgh, PA, USA.\n\nJaechan Lim, University of Michigan, Ann Arbor, MI, USA.\n\nCole R. Julick, University of Nebraska\u2013Lincoln, Lincoln, NE, USA.\n\nEunseong Moon, University of Michigan, Ann Arbor, MI, USA.\n\nYi Sun, University of Michigan, Ann Arbor, MI, USA.\n\nJamie Phillips, University of Delaware, Newark, DE, USA.\n\nKristi L Montooth, University of Nebraska\u2013Lincoln, Lincoln, NE, USA.\n\nDelbert A. Green II, University of Michigan, Ann Arbor, MI, USA.\n\nHun-Seok Kim, University of Michigan, Ann Arbor, MI, USA.\n\nDavid Theodore Blaauw, University of Michigan, Ann Arbor, MI, USA.\n\n  * Share\n\n    * Twitter\n    * Reddit\n    * Hacker News\n  * Download PDF\n  * Print\n  * Join the Discussion\n\nSubmit an Article to CACM\n\nCACM welcomes unsolicited submissions on topics of relevance and value to the\ncomputing community.\n\nYou Just Read\n\n#### mSAIL: Milligram-Scale Multi-Modal Sensor Platform for Monarch Butterfly\nMigration Tracking\n\nView in the ACM Digital Library\n\n\u00a9 2024 Copyright held by the owner/author(s). Publication rights licensed to\nACM.\n\n### DOI\n\n10.1145/3611105\n\nAdvertisement\n\nAdvertisement\n\n### Join the Discussion (0)\n\n#### Become a Member or Sign In to Post a Comment\n\nSign In Sign Up\n\n### The Latest from CACM\n\nExplore More\n\nBLOG@CACM Apr 16 2024\n\nThe Value of Data in Embodied Artificial Intelligence\n\nShaoshan Liu\n\nArtificial Intelligence and Machine Learning\n\nNews Apr 15 2024\n\n\u2018Not Our Problem\u2019\n\nDavid Geer\n\nData and Information\n\nNews Apr 11 2024\n\nScientific Applications of Generative AI\n\nBennie Mols\n\nArtificial Intelligence and Machine Learning\n\n### Shape the Future of Computing\n\nACM encourages its members to take a direct hand in shaping the future of the\nassociation. There are more ways than ever to get involved.\n\nGet Involved\n\n### Communications of the ACM (CACM) is now a fully Open Access publication.\n\nBy opening CACM to the world, we hope to increase engagement among the broader\ncomputer science community and encourage non-members to discover the rich\nresources ACM has to offer.\n\nLearn More\n\nTopics\n\n  * Architecture and Hardware\n  * Artificial Intelligence and Machine Learning\n  * Computer History\n  * Computing Applications\n  * Computing Profession\n  * Data and Information\n  * Education\n  * HCI\n  * Philosophy of Computing\n  * Security and Privacy\n  * Society\n  * Software Engineering and Programming Languages\n  * Systems and Networking\n  * Theory\n\nMagazine\n\n  * Latest Issue\n  * Magazine Archive\n  * Editorial Staff and Board\n  * Submit an Article\n  * Alerts & Feeds\n  * Author Guidelines\n\nCommunications of the ACM\n\n  * About Us\n  * Frequently Asked Questions\n  * Contact Us\n  * For Advertisers\n  * Join ACM\n\n\u00a9 2024 Communications of the ACM. All Rights Reserved.\n\n  * Cookie Notice\n  * Privacy Policy\n\nBy continuing to use our website, you are agreeing to our use of cookies. To\nfind out more, please see our Privacy Policy.\n\n", "frontpage": false}
