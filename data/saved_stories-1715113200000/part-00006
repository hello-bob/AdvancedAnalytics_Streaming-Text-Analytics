{"aid": "40284111", "title": "Novel attack against virtually all VPN apps neuters their entire purpose", "url": "https://arstechnica.com/security/2024/05/novel-attack-against-virtually-all-vpn-apps-neuters-their-entire-purpose/", "domain": "arstechnica.com", "votes": 39, "user": "quibuss", "posted_at": "2024-05-07 10:47:46", "comments": 8, "source_title": "Novel attack against virtually all VPN apps neuters their entire purpose", "source_text": "Novel attack against virtually all VPN apps neuters their entire purpose | Ars Technica\n\nSkip to main content\n\nSubscribe\n\nClose\n\n### Navigate\n\n  * Store\n  * Subscribe\n  * Videos\n  * Features\n  * Reviews\n\n  * RSS Feeds\n  * Mobile Site\n\n  * About Ars\n  * Staff Directory\n  * Contact Us\n\n  * Advertise with Ars\n  * Reprints\n\n### Filter by topic\n\n  * Biz & IT\n  * Tech\n  * Science\n  * Policy\n  * Cars\n  * Gaming & Culture\n  * Store\n  * Forums\n\n### Settings\n\nFront page layout\n\nGrid\n\nList\n\nSite theme\n\nlight\n\ndark\n\nSign in\n\n#### VPN BUSTER \u2014\n\n# Novel attack against virtually all VPN apps neuters their entire purpose\n\n## TunnelVision vulnerability has existed since 2002 and may already be known\nto attackers.\n\nDan Goodin - 5/6/2024, 8:35 PM\n\nEnlarge\n\nGetty Images\n\n#### reader comments\n\n157\n\nResearchers have devised an attack against nearly all virtual private network\napplications that forces them to send and receive some or all traffic outside\nof the encrypted tunnel designed to protect it from snooping or tampering.\n\nTunnelVision, as the researchers have named their attack, largely negates the\nentire purpose and selling point of VPNs, which is to encapsulate incoming and\noutgoing Internet traffic in an encrypted tunnel and to cloak the user\u2019s IP\naddress. The researchers believe it affects all VPN applications when they\u2019re\nconnected to a hostile network and that there are no ways to prevent such\nattacks except when the user's VPN runs on Linux or Android. They also said\ntheir attack technique may have been possible since 2002 and may already have\nbeen discovered and used in the wild since then.\n\n## Reading, dropping, or modifying VPN traffic\n\nThe effect of TunnelVision is \u201cthe victim's traffic is now decloaked and being\nrouted through the attacker directly,\u201d a video demonstration explained. \u201cThe\nattacker can read, drop or modify the leaked traffic and the victim maintains\ntheir connection to both the VPN and the Internet.\u201d\n\nTunnelVision - CVE-2024-3661 - Decloaking Full and Split Tunnel VPNs -\nLeviathan Security Group.\n\nThe attack works by manipulating the DHCP server that allocates IP addresses\nto devices trying to connect to the local network. A setting known as option\n121 allows the DHCP server to override default routing rules that send VPN\ntraffic through a local IP address that initiates the encrypted tunnel. By\nusing option 121 to route VPN traffic through the DHCP server, the attack\ndiverts the data to the DHCP server itself. Researchers from Leviathan\nSecurity explained:\n\nAdvertisement\n\n> Our technique is to run a DHCP server on the same network as a targeted VPN\n> user and to also set our DHCP configuration to use itself as a gateway. When\n> the traffic hits our gateway, we use traffic forwarding rules on the DHCP\n> server to pass traffic through to a legitimate gateway while we snoop on it.\n>\n> We use DHCP option 121 to set a route on the VPN user\u2019s routing table. The\n> route we set is arbitrary and we can also set multiple routes if needed. By\n> pushing routes that are more specific than a /0 CIDR range that most VPNs\n> use, we can make routing rules that have a higher priority than the routes\n> for the virtual interface the VPN creates. We can set multiple /1 routes to\n> recreate the 0.0.0.0/0 all traffic rule set by most VPNs.\n>\n> Pushing a route also means that the network traffic will be sent over the\n> same interface as the DHCP server instead of the virtual network interface.\n> This is intended functionality that isn\u2019t clearly stated in the RFC.\n> Therefore, for the routes we push, it is never encrypted by the VPN\u2019s\n> virtual interface but instead transmitted by the network interface that is\n> talking to the DHCP server. As an attacker, we can select which IP addresses\n> go over the tunnel and which addresses go over the network interface talking\n> to our DHCP server.\n>\n> Enlarge / A malicious DHCP option 121 route that causes traffic to never be\n> encrypted by the VPN process.\n>\n> Leviathan Security\n>\n> We now have traffic being transmitted outside the VPN\u2019s encrypted tunnel.\n> This technique can also be used against an already established VPN\n> connection once the VPN user\u2019s host needs to renew a lease from our DHCP\n> server. We can artificially create that scenario by setting a short lease\n> time in the DHCP lease, so the user updates their routing table more\n> frequently. In addition, the VPN control channel is still intact because it\n> already uses the physical interface for its communication. In our testing,\n> the VPN always continued to report as connected, and the kill switch was\n> never engaged to drop our VPN connection.\n\nThe attack can most effectively be carried out by a person who has\nadministrative control over the network the target is connecting to. In that\nscenario, the attacker configures the DHCP server to use option 121. It\u2019s also\npossible for people who can connect to the network as an unprivileged user to\nperform the attack by setting up their own rogue DHCP server.\n\nAdvertisement\n\nThe attack allows some or all traffic to be routed through the unencrypted\ntunnel. In either case, the VPN application will report that all data is being\nsent through the protected connection. Any traffic that\u2019s diverted away from\nthis tunnel will not be encrypted by the VPN and the Internet IP address\nviewable by the remote user will belong to the network the VPN user is\nconnected to, rather than one designated by the VPN app.\n\nInterestingly, Android is the only operating system that fully immunizes VPN\napps from the attack because it doesn't implement option 121. For all other\nOSes, there are no complete fixes. When apps run on Linux there\u2019s a setting\nthat minimizes the effects, but even then TunnelVision can be used to exploit\na side channel that can be used to de-anonymize destination traffic and\nperform targeted denial-of-service attacks. Network firewalls can also be\nconfigured to deny inbound and outbound traffic to and from the physical\ninterface. This remedy is problematic for two reasons: (1) a VPN user\nconnecting to an untrusted network has no ability to control the firewall and\n(2) it opens the same side channel present with the Linux mitigation.\n\nThe most effective fixes are to run the VPN inside of a virtual machine whose\nnetwork adapter isn\u2019t in bridged mode or to connect the VPN to the Internet\nthrough the Wi-Fi network of a cellular device. The research, from Leviathan\nSecurity researchers Lizzie Moratti and Dani Cronce, is available here.\n\n### Ars Video\n\n#### reader comments\n\n157\n\nDan Goodin Dan Goodin is Senior Security Editor at Ars Technica, where he\noversees coverage of malware, computer espionage, botnets, hardware hacking,\nencryption, and passwords. In his spare time, he enjoys gardening, cooking,\nand following the independent music scene.\n\nAdvertisement\n\n## Promoted Comments\n\nmktogeek\n\nI think it's important to clarify the use of the term \"VPN\" here. This affects\n\"VPNs\" used for anonymizing internet traffic or for geofence defeating on\nstreaming services and such. It should not impact VPNs used to access private\nnetworks via the Internet.\n\nFor example, if you use a VPN to connect to your home network and access\nmachines inside your LAN that are not directly exposed to the internet, this\nwon't affect that at all. It only affects VPN setups that redirect all\nInternet traffic via the VPN.\n\nYou may also be able to partially defeat it by not using a /0 route. You could\ninstead do four routing entries with /2 networks. Of course, if the hacker\nsets up their network the same way, this could also be defeated.\n\nMay 6, 2024 at 8:59 pm\n\n### Channel Ars Technica\n\n#### Unsolved Mysteries Of Quantum Leap With Donald P. Bellisario\n\nToday \"Quantum Leap\" series creator Donald P. Bellisario joins Ars Technica to\nanswer once and for all the lingering questions we have about his enduringly\npopular show. Was Dr. Sam Beckett really leaping between all those time\nperiods and people or did he simply imagine it all? What do people in the\nwaiting room do while Sam is in their bodies? What happens to Sam's loyal ally\nAl? 30 years following the series finale, answers to these mysteries and more\nawait.\n\n  * ##### Unsolved Mysteries Of Quantum Leap With Donald P. Bellisario\n\n  * ##### Unsolved Mysteries Of Warhammer 40K With Author Dan Abnett\n\n  * ##### SITREP: F-16 replacement search a signal of F-35 fail?\n\n  * ##### Sitrep: Boeing 707\n\n  * ##### Steve Burke of GamersNexus Reacts To Their Top 1000 Comments On YouTube\n\n  * ##### Modern Vintage Gamer Reacts To His Top 1000 Comments On YouTube\n\n  * ##### How The NES Conquered A Skeptical America In 1985\n\n  * ##### Scott Manley Reacts To His Top 1000 YouTube Comments\n\n  * ##### How Horror Works in Amnesia: Rebirth, Soma and Amnesia: The Dark Descent\n\n  * ##### LGR's Clint Basinger Reacts To His Top 1000 YouTube Comments\n\n  * ##### The F-35's next tech upgrade\n\n  * ##### How One Gameplay Decision Changed Diablo Forever\n\n  * ##### Unsolved Mortal Kombat Mysteries With Dominic Cianciolo From NetherRealm Studios\n\n  * ##### US Navy Gets an Italian Accent\n\n  * ##### How Amazon\u2019s \u201cUndone\u201d Animates Dreams With Rotoscoping And Oil Paints\n\n  * ##### Fighter Pilot Breaks Down Every Button in an F-15 Cockpit\n\n  * ##### How NBA JAM Became A Billion-Dollar Slam Dunk\n\n  * ##### Linus \"Tech Tips\" Sebastian Reacts to His Top 1000 YouTube Comments\n\n  * ##### How Alan Wake Was Rebuilt 3 Years Into Development\n\n  * ##### How Prince of Persia Defeated Apple II's Memory Limitations\n\n  * ##### How Crash Bandicoot Hacked The Original Playstation\n\n  * ##### Myst: The challenges of CD-ROM | War Stories\n\n  * ##### Markiplier Reacts To His Top 1000 YouTube Comments\n\n  * ##### How Mind Control Saved Oddworld: Abe's Oddysee\n\n  * ##### Bioware answers unsolved mysteries of the Mass Effect universe\n\n  * ##### Civilization: It's good to take turns | War Stories\n\n  * ##### SITREP: DOD Resets Ballistic Missile Interceptor program\n\n  * ##### Warframe's Rebecca Ford reviews your characters\n\n  * ##### Subnautica: A world without guns | War Stories\n\n  * ##### How Slay the Spire\u2019s Original Interface Almost Killed the Game | War Stories\n\n  * ##### Amnesia: The Dark Descent - The horror facade | War Stories\n\n  * ##### Command & Conquer: Tiberian Sun | War Stories\n\n  * ##### Blade Runner: Skinjobs, voxels, and future noir | War Stories\n\n  * ##### Dead Space: The Drag Tentacle | War Stories\n\n  * ##### Teach the Controversy: Flat Earthers\n\n  * ##### Delta V: The Burgeoning World of Small Rockets, Paul Allen's Huge Plane, and SpaceX Gets a Crucial Green-light\n\n  * ##### Chris Hadfield explains his 'Space Oddity' video\n\n  * ##### The Greatest Leap, Episode 1: Risk\n\n  * ##### Ultima Online: The Virtual Ecology | War Stories\n\nMore videos\n\n\u2190 Previous story Next story \u2192\n\n### Related Stories\n\n### Today on Ars\n\nCNMN Collection WIRED Media Group \u00a9 2024 Cond\u00e9 Nast. All rights reserved. Use of and/or registration on any portion of this site constitutes acceptance of our User Agreement (updated 1/1/20) and Privacy Policy and Cookie Statement (updated 1/1/20) and Ars Technica Addendum (effective 8/21/2018). Ars may earn compensation on sales from links on this site. Read our affiliate link policy. Your California Privacy Rights | Manage Preferences The material on this site may not be reproduced, distributed, transmitted, cached or otherwise used, except with the prior written permission of Cond\u00e9 Nast. Ad Choices\n\n## We Care About Your Privacy\n\nWe and our 166 partners store and/or access information on a device, such as\nunique IDs in cookies to process personal data. You may accept or manage your\nchoices by clicking below or at any time in the privacy policy page. These\nchoices will be signaled to our partners and will not affect browsing\ndata.More information about your privacy\n\n### We and our partners process data to provide:\n\nUse precise geolocation data. Actively scan device characteristics for\nidentification. Store and/or access information on a device. Personalised\nadvertising and content, advertising and content measurement, audience\nresearch and services development.\n\n", "frontpage": true}
